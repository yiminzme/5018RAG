Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/3doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 1
num_documents_in_context: 3
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 1
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 2
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 3
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 4
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 5
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 6
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 7
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 8
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 9
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 10
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 11
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 12
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 13
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 14
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 15
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 16
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 17
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 18
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 19
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 20
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 21
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 22
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 23
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 24
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 25
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 26
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 27
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 28
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 29
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 30
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 31
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 32
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 33
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 34
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 35
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 36
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 37
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 38
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 39
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 40
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 41
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 42
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 43
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 44
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 45
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 46
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 47
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 48
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 49
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 50
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 51
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 52
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 53
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 54
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 55
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 56
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 57
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 58
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 59
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 60
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 61
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 62
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 63
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 64
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 65
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 66
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 67
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 68
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 69
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 70
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 71
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 72
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 73
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 74
Sorted Documents: [1, 0, 2]
Removed Distracting Documents: [1, 0]
Final Improved Documents: [2]


Example 75
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 76
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 77
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 78
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 79
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 80
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 81
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 82
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 83
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 84
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 85
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 86
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 87
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 88
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 89
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 90
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 91
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 92
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 93
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 94
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 95
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 96
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 97
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 98
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 99
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 100
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 101
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 102
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 103
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 104
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 105
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 106
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 107
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 108
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 109
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 110
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 111
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 112
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 113
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 114
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 115
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 116
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 117
Sorted Documents: [2, 0, 1]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1]


Example 118
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 119
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 120
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 121
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 122
Sorted Documents: [1, 0, 2]
Removed Distracting Documents: [1]
Final Improved Documents: [0, 2]


Example 123
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 124
Sorted Documents: [2, 1, 0]
Removed Distracting Documents: [2]
Final Improved Documents: [1, 0]


Example 125
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 126
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 127
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 128
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 129
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 130
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 131
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 132
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 133
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 134
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 135
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 136
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 137
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 138
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 139
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 140
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 141
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 142
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 143
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 144
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 145
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 146
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 147
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 148
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 149
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 150
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 151
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 152
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 153
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 1
NUM DOCUMENTS IN CONTEXT: 3
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:03<00:28,  3.60s/it] 22%|██▏       | 2/9 [00:08<00:31,  4.44s/it] 33%|███▎      | 3/9 [00:13<00:27,  4.63s/it] 44%|████▍     | 4/9 [00:18<00:23,  4.79s/it] 56%|█████▌    | 5/9 [00:23<00:19,  4.84s/it] 67%|██████▋   | 6/9 [00:28<00:14,  4.92s/it] 78%|███████▊  | 7/9 [00:33<00:10,  5.03s/it] 89%|████████▉ | 8/9 [00:38<00:05,  5.06s/it]100%|██████████| 9/9 [00:42<00:00,  4.74s/it]100%|██████████| 9/9 [00:43<00:00,  4.78s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  576.3605515956879
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/4doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 2
num_documents_in_context: 4
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 1
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 3
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 4
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 6
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 3, 1]


Example 7
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 8
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 9
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 11
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 13
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 14
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 15
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 16
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 17
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 18
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 19
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 20
Sorted Documents: [3, 0, 1, 2]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [1, 2]


Example 21
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 22
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 23
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 24
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 25
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 26
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 27
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 28
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 29
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 30
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 31
Sorted Documents: [2, 1, 3, 0]
Removed Distracting Documents: [2, 1]
Final Improved Documents: [3, 0]


Example 32
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 33
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 34
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 35
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 37
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 38
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 39
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 40
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 41
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 42
Sorted Documents: [1, 3, 0, 2]
Removed Distracting Documents: [1]
Final Improved Documents: [3, 0, 2]


Example 43
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 44
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 45
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 47
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 48
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 49
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 50
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 51
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 52
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 53
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 54
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 55
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 56
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 57
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 58
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 59
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 60
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 61
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 63
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 64
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 65
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1, 3]


Example 66
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 67
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 68
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 69
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 70
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 71
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 72
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 73
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 74
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 76
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 78
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 79
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 80
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 82
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 83
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 84
Sorted Documents: [0, 3, 2, 1]
Removed Distracting Documents: [0, 3, 2]
Final Improved Documents: [1]


Example 85
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 86
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 87
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 88
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 89
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 90
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 91
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 92
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 93
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 94
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 96
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 97
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 99
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 100
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 101
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 102
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 103
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 104
Sorted Documents: [1, 2, 3, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 3, 0]


Example 105
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 106
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 107
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 108
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 109
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 110
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 111
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 112
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0, 3]
Final Improved Documents: [1, 2]


Example 113
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 114
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 115
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 116
Sorted Documents: [1, 3, 2, 0]
Removed Distracting Documents: [1, 3]
Final Improved Documents: [2, 0]


Example 117
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 118
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 119
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 120
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 121
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 122
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 123
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 126
Sorted Documents: [2, 0, 3, 1]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [3, 1]


Example 127
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 128
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 129
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 131
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 132
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 133
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 134
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 135
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 136
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 137
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 138
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 139
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 140
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 141
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 142
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 143
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 144
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 145
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 146
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 147
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 148
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 149
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 150
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 151
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 152
Sorted Documents: [2, 1, 3, 0]
Removed Distracting Documents: [2, 1]
Final Improved Documents: [3, 0]


Example 153
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 4
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:43,  5.46s/it] 22%|██▏       | 2/9 [00:10<00:35,  5.14s/it] 33%|███▎      | 3/9 [00:13<00:25,  4.20s/it] 44%|████▍     | 4/9 [00:18<00:23,  4.73s/it] 56%|█████▌    | 5/9 [00:24<00:19,  4.90s/it] 67%|██████▋   | 6/9 [00:29<00:14,  4.99s/it] 78%|███████▊  | 7/9 [00:34<00:10,  5.05s/it] 89%|████████▉ | 8/9 [00:39<00:05,  5.04s/it]100%|██████████| 9/9 [00:43<00:00,  4.75s/it]100%|██████████| 9/9 [00:43<00:00,  4.86s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  623.596444606781
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.67s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/5doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 2
num_documents_in_context: 5
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 1
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 3
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 4
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 6
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 7
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 8
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 9
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 11
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 13
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 14
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 15
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 16
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 17
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 18
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 19
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 20
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 21
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 22
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 24
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 25
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 26
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 27
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 28
Sorted Documents: [0, 2, 4, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [3, 1]


Example 29
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 30
Sorted Documents: [4, 2, 0, 1, 3]
Removed Distracting Documents: [4, 2, 0]
Final Improved Documents: [1, 3]


Example 31
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 32
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 33
Sorted Documents: [0, 1, 3, 4, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 4, 2]


Example 34
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 35
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [1, 3]


Example 37
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 38
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 39
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 40
Sorted Documents: [3, 1, 4, 0, 2]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [4, 0, 2]


Example 41
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 42
Sorted Documents: [4, 4, 2, 1, 0, 3]
Removed Distracting Documents: [4, 4, 2]
Final Improved Documents: [1, 0, 3]


Example 43
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 44
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 45
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 47
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 48
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 49
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 50
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 51
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 52
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 53
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 55
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 56
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 57
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 58
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 59
Sorted Documents: [4, 0, 3, 1, 2]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 2]


Example 60
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 61
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 63
Sorted Documents: [2, 0, 1, 3, 4]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3, 4]


Example 64
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 65
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 66
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [1, 3]


Example 67
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 68
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 69
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 70
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 71
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 73
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 74
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 76
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 78
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 79
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 80
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 82
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 83
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 84
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 85
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 86
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 87
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 88
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 89
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 90
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 91
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 93
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 94
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 96
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 97
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 99
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 100
Sorted Documents: [0, 3, 1, 2, 4]
Removed Distracting Documents: [0, 3]
Final Improved Documents: [1, 2, 4]


Example 101
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 102
Sorted Documents: [4, 0, 2, 3, 1]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [3, 1]


Example 103
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 104
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 105
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 106
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 107
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 108
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 109
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 110
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 111
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 112
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 113
Sorted Documents: [0, 2, 3, 1, 4]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1, 4]


Example 114
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 115
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 116
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 117
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 118
Sorted Documents: [0, 2, 4, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [3, 1]


Example 119
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 120
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 121
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 122
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 123
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 126
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [4, 1, 3]


Example 127
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 128
Sorted Documents: [3, 0, 2, 4, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [4, 1]


Example 129
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 131
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 132
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 133
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 134
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 135
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 136
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 137
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 138
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 139
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 140
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 141
Sorted Documents: [4, 3, 0, 2, 1]
Removed Distracting Documents: [4, 3, 0, 2]
Final Improved Documents: [1]


Example 142
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 143
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 144
Sorted Documents: [2, 0, 4, 3, 1]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [3, 1]


Example 145
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 146
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 147
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 148
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 149
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 150
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 151
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 152
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 153
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 5
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:03<00:28,  3.59s/it] 22%|██▏       | 2/9 [00:08<00:30,  4.41s/it] 33%|███▎      | 3/9 [00:13<00:27,  4.52s/it] 44%|████▍     | 4/9 [00:17<00:21,  4.24s/it] 56%|█████▌    | 5/9 [00:20<00:16,  4.01s/it] 67%|██████▋   | 6/9 [00:26<00:13,  4.49s/it] 78%|███████▊  | 7/9 [00:30<00:09,  4.56s/it] 89%|████████▉ | 8/9 [00:34<00:04,  4.43s/it]100%|██████████| 9/9 [00:37<00:00,  3.76s/it]100%|██████████| 9/9 [00:37<00:00,  4.14s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  805.9492483139038
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.64s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/6doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 6
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 3
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 6
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 7
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 8
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 10
Sorted Documents: [3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 11
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 13
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 16
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [3, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 18
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 19
Sorted Documents: [3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 20
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 21
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 24
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 25
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 26
Sorted Documents: [4, 5, 0, 3, 1, 2]
Removed Distracting Documents: [4, 5, 0, 3]
Final Improved Documents: [1, 2]


Example 27
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 29
Sorted Documents: [3, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 30
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 32
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 34
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [0, 2, 4, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 39
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 40
Sorted Documents: [3, 5, 1, 4, 0, 2]
Removed Distracting Documents: [3, 5, 1]
Final Improved Documents: [4, 0, 2]


Example 41
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 43
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 44
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 47
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 49
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 50
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 53
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 55
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 56
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 57
Sorted Documents: [2, 0, 4, 5, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 59
Sorted Documents: [3, 0, 5, 4, 1, 2]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 2]


Example 60
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 61
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 62
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 63
Sorted Documents: [5, 3, 0, 2, 1, 4]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4]


Example 64
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 69
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 70
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4, 5]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5]


Example 73
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [5, 3, 0, 2, 4, 1]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [4, 1]


Example 75
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 76
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 82
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 84
Sorted Documents: [4, 0, 3, 1, 5, 2]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 5, 2]


Example 85
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 86
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 88
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [3, 0, 5, 4, 1, 2]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 2]


Example 90
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [5, 0, 1, 2, 3, 4]
Removed Distracting Documents: [5, 0, 1]
Final Improved Documents: [2, 3, 4]


Example 93
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 94
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 96
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 98
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 99
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 100
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 101
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 103
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 105
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 106
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 107
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 109
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 110
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 112
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 114
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 115
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 116
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 117
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 118
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 119
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 120
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 121
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 122
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 126
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 128
Sorted Documents: [4, 0, 3, 1, 2, 5]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 2, 5]


Example 129
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 131
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 132
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 133
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 135
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 136
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 137
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 0, 3]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 0, 3]


Example 139
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 141
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 142
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 143
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 145
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 147
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 149
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 150
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 151
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 152
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 153
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 6
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:42,  5.29s/it] 22%|██▏       | 2/9 [00:10<00:38,  5.46s/it] 33%|███▎      | 3/9 [00:13<00:24,  4.09s/it] 44%|████▍     | 4/9 [00:18<00:23,  4.66s/it] 56%|█████▌    | 5/9 [00:23<00:18,  4.71s/it] 67%|██████▋   | 6/9 [00:28<00:14,  4.83s/it] 78%|███████▊  | 7/9 [00:32<00:08,  4.49s/it] 89%|████████▉ | 8/9 [00:36<00:04,  4.43s/it]100%|██████████| 9/9 [00:39<00:00,  3.74s/it]100%|██████████| 9/9 [00:39<00:00,  4.34s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  839.7807731628418
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1, 6]


Example 71
Sorted Documents: [3, 1, 6, 5, 0, 2, 4]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [6, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:38,  4.83s/it] 22%|██▏       | 2/9 [00:10<00:36,  5.15s/it] 33%|███▎      | 3/9 [00:15<00:30,  5.14s/it] 44%|████▍     | 4/9 [00:21<00:27,  5.42s/it] 56%|█████▌    | 5/9 [00:27<00:22,  5.72s/it] 67%|██████▋   | 6/9 [00:31<00:15,  5.19s/it] 78%|███████▊  | 7/9 [00:37<00:10,  5.41s/it] 89%|████████▉ | 8/9 [00:41<00:04,  4.94s/it]100%|██████████| 9/9 [00:44<00:00,  4.38s/it]100%|██████████| 9/9 [00:44<00:00,  4.96s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  839.2699704170227
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.92s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.71s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.90s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/8doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 4
num_documents_in_context: 8
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 2
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 3
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 5
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 6
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 8
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 9
Sorted Documents: [3, 5, 0, 6, 4, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [7, 1, 2]


Example 10
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 11
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 13
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 14
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 18
Sorted Documents: [6, 0, 5, 1, 4, 2, 7, 3]
Removed Distracting Documents: [6, 0, 5]
Final Improved Documents: [1, 4, 2, 7, 3]


Example 19
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 20
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 22
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 23
Sorted Documents: [3, 6, 4, 1, 7, 5, 0, 2]
Removed Distracting Documents: [3, 6, 4, 1]
Final Improved Documents: [7, 5, 0, 2]


Example 24
Sorted Documents: [4, 0, 5, 2, 7, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [7, 6, 1, 3]


Example 25
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 26
Sorted Documents: [1, 7, 6, 4, 3, 2, 5, 0]
Removed Distracting Documents: [1, 7, 6, 4, 3, 2]
Final Improved Documents: [5, 0]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 28
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 29
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 31
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 33
Sorted Documents: [7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [4, 0, 6, 1, 2, 7, 3, 5]
Removed Distracting Documents: [4, 0, 6, 1]
Final Improved Documents: [2, 7, 3, 5]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 40
Sorted Documents: [3, 5, 0, 6, 4, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [7, 1, 2]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 7, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 45
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 46
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 47
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 49
Sorted Documents: [4, 7, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 7, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [6, 4, 0, 2, 7, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 51
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 0, 5, 2, 6, 1, 7, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 53
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [7, 3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [7, 3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 55
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 56
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 57
Sorted Documents: [6, 2, 0, 4, 5, 3, 1, 7]
Removed Distracting Documents: [6, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 7]


Example 58
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 61
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 63
Sorted Documents: [3, 0, 5, 4, 1, 6, 2, 7]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 6, 2, 7]


Example 64
Sorted Documents: [4, 0, 6, 2, 5, 1, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3, 7]


Example 65
Sorted Documents: [7, 3, 1, 5, 4, 0, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5]
Final Improved Documents: [4, 0, 2, 6]


Example 66
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 67
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 69
Sorted Documents: [5, 0, 6, 7, 2, 3, 1, 4]
Removed Distracting Documents: [5, 0, 6, 7, 2]
Final Improved Documents: [3, 1, 4]


Example 70
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.2
            },
            {
                "index": 4,
                "score": 0.8
            },
            {
                "index": 5,
                "score": 0.1
            },
            {
                "index": 6,
                "score": 0.4
            },
            {
                "index": 7,
                "score": 0.6
            },
            {
                "index": 8,
                "score
Example 72
Sorted Documents: [5, 0, 7, 2, 4, 6, 1, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [4, 6, 1, 3]


Example 73
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 74
Sorted Documents: [4, 2, 7, 0, 5, 3, 1, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [2, 7, 0, 5, 3, 1, 6]


Example 75
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 76
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 78
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 79
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 80
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 81
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 83
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 85
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 89
Sorted Documents: [7, 5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [7, 5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 92
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 93
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 2]


Example 94
Sorted Documents: [7, 2, 1, 6, 4, 5, 3, 0]
Removed Distracting Documents: [7, 2, 1, 6]
Final Improved Documents: [4, 5, 3, 0]


Example 95
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 97
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 100
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 101
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 105
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 107
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 108
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 109
Sorted Documents: [6, 3, 0, 5, 2, 4, 1, 7]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1, 7]


Example 110
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 111
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 112
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 113
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 114
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.1
            },
            {
                "index": 4,
                "score": 0.9
            },
            {
                "index": 5,
                "score": 0.2
            },
            {
                "index": 6,
                "score": 0.8
            },
            {
                "index": 7,
                "score": 0.3
            },
            {
                "index": 8,
                "score
Example 115
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 116
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 117
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 121
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 122
Sorted Documents: [0, 2, 6, 7, 4, 1, 3, 5]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [6, 7, 4, 1, 3, 5]


Example 123
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [7, 0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [6, 4, 0, 2, 7, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 129
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.1
            },
            {
                "index": 4,
                "score": 0.9
            },
            {
                "index": 5,
                "score": 0.6
            },
            {
                "index": 6,
                "score": 0.4
            },
            {
                "index": 7,
                "score": 0.8
            },
            {
                "index": 8,
                "score
Example 130
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                Document 1:
                "score": 0.3
            },
            {
                "index": 3,
                Document 2:
                "score": 0.5
            },
            {
                "index": 4,
                Document 3:
                "score": 0.2
            },
            {
                "index": 5,
                Document 4:
                "score": 0.4
            },
            {
                "index": 6,
                Document 5:
                "score": 0.1
            },
            {
                "index": 7,
                Document 6:
                "score": 0.3
            },
Example 131
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 134
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 136
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 138
Sorted Documents: [3, 7, 4, 5, 6, 2, 0, 1]
Removed Distracting Documents: [3, 7, 4, 5, 6]
Final Improved Documents: [2, 0, 1]


Example 139
Sorted Documents: [3, 6, 4, 1, 7, 5, 0, 2]
Removed Distracting Documents: [3, 6, 4, 1]
Final Improved Documents: [7, 5, 0, 2]


Example 140
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                "score": 0.3
            },
            {
                "index": 3,
                "score": 0.5
            },
            {
                "index": 4,
                "score": 0.1
            },
            {
                "index": 5,
                "score": 0.9
            },
            {
                "index": 6,
                "score": 0.2
            },
            {
                "index": 7,
                "score": 0.8
            },
            {
                "index": 8,
                "score": 0.4
            },
            {
                "index": 9,
                "score
Example 141
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 142
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 144
Sorted Documents: [6, 2, 0, 4, 3, 1, 7, 5]
Removed Distracting Documents: [6, 2, 0, 4]
Final Improved Documents: [3, 1, 7, 5]


Example 145
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 146
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 147
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 148
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 149
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 150
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 151
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 8
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:47,  5.91s/it] 22%|██▏       | 2/9 [00:09<00:31,  4.50s/it] 33%|███▎      | 3/9 [00:14<00:29,  4.92s/it] 44%|████▍     | 4/9 [00:22<00:29,  5.89s/it] 56%|█████▌    | 5/9 [00:29<00:25,  6.29s/it] 67%|██████▋   | 6/9 [00:34<00:17,  5.98s/it] 78%|███████▊  | 7/9 [00:41<00:12,  6.31s/it] 89%|████████▉ | 8/9 [00:49<00:06,  6.81s/it]100%|██████████| 9/9 [00:52<00:00,  5.53s/it]100%|██████████| 9/9 [00:52<00:00,  5.80s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  843.3349335193634
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/9doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 4
num_documents_in_context: 9
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 5, 3]


Example 3
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 5
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 6
Sorted Documents: [7, 3, 1, 5, 6, 8, 4, 0, 2]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3]


Example 8
Sorted Documents: [7, 4, 0, 5, 2, 8, 6, 1, 3]
Removed Distracting Documents: [7, 4, 0, 5, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 9
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 10
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 11
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 12
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 13
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 14
Sorted Documents: [6, 3, 0, 7, 5, 2, 8, 4, 1]
Removed Distracting Documents: [6, 3, 0, 7, 5, 2]
Final Improved Documents: [8, 4, 1]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 17
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 18
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 19
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 20
Sorted Documents: [3, 7, 0, 5, 4, 8, 1, 6, 2]
Removed Distracting Documents: [3, 7, 0, 5, 4]
Final Improved Documents: [8, 1, 6, 2]


Example 21
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 22
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 23
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 24
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 25
Warning: No valid JSON found in LLM response.
[
            { "index": 1, "score": 0.7 }, // Document 1: Very unlikely to contain the correct answer
            { "index": 2, "score": 0.3 }, // Document 2: Unlikely to contain the correct answer
            { "index": 3, "score": 0.5 }, // Document 3: Somewhat likely to contain the correct answer
            { "index": 4, "score": 0.1 }, // Document 4: Very unlikely to contain the correct answer
            { "index": 5, "score": 0.8 }, // Document 5: Somewhat likely to contain the correct answer
            { "index": 6, "score": 0.2 }, // Document 6: Unlikely to contain the correct answer
            { "index": 7, "score": 0.4 }, // Document 7: Somewhat likely to contain the correct answer
            { "index": 8, "score": 0.6 }, // Document 8: Very unlikely to contain the correct answer
            { "index": 9, "score": 0.3 } // Document 9: Unlikely to contain the correct answer
Example 26
Sorted Documents: [4, 8, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 8, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 28
Sorted Documents: [7, 4, 0, 6, 2, 5, 1, 8, 3]
Removed Distracting Documents: [7, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 3]


Example 29
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 30
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 31
Sorted Documents: [7, 1, 5, 6, 8, 4, 0, 2, 3]
Removed Distracting Documents: [7, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2, 3]


Example 32
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 33
Sorted Documents: [8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 34
Sorted Documents: [5, 0, 7, 2, 8, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 4, 3]


Example 35
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 36
Sorted Documents: [4, 0, 3, 7, 8, 1, 5, 2, 6]
Removed Distracting Documents: [4, 0, 3, 7]
Final Improved Documents: [8, 1, 5, 2, 6]


Example 37
Sorted Documents: [1, 4, 6, 3, 8, 5, 0, 7, 2]
Removed Distracting Documents: [1, 4, 6, 3]
Final Improved Documents: [8, 5, 0, 7, 2]


Example 38
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 39
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 40
Sorted Documents: [6, 5, 1, 3, 2, 0, 7, 4, 8]
Removed Distracting Documents: [6, 5, 1, 3]
Final Improved Documents: [2, 0, 7, 4, 8]


Example 41
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 44
Sorted Documents: [4, 7, 0, 2, 8, 1, 5, 3, 6]
Removed Distracting Documents: [4, 7, 0, 2, 8]
Final Improved Documents: [1, 5, 3, 6]


Example 45
Sorted Documents: [4, 0, 6, 2, 8, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3, 5]


Example 46
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 5, 3]


Example 47
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 48
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 49
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 50
Sorted Documents: [4, 0, 6, 2, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 52
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 53
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 8, 2, 0, 6]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 6]


Example 55
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 56
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 5, 3]


Example 57
Sorted Documents: [6, 2, 0, 4, 5, 3, 1, 8, 7]
Removed Distracting Documents: [6, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 8, 7]


Example 58
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 59
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 61
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 63
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 64
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 3, 7]


Example 65
Sorted Documents: [7, 1, 3, 4, 8, 2, 0, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 5, 6]


Example 66
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 67
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 68
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 69
Error in processing LLM response: Expecting value: line 2 column 43 (char 44). Returning all documents by default.
Example 70
Sorted Documents: [0, 6, 2, 4, 8, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [4, 8, 1, 7, 3, 5]


Example 71
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8]


Example 73
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [7, 5, 1, 3, 4, 8, 2, 0, 6]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 6]


Example 75
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 76
Sorted Documents: [2, 5, 0, 7, 4, 8, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 7, 4]
Final Improved Documents: [8, 1, 6, 3]


Example 77
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 78
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 79
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 81
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 82
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 83
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 84
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 85
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 86
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 87
Sorted Documents: [7, 0, 5, 2, 8, 4, 1, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [8, 4, 1, 3, 6]


Example 88
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 89
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 92
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 93
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 94
Sorted Documents: [8, 6, 7, 4, 1, 5, 2, 3, 0]
Removed Distracting Documents: [8, 6, 7, 4]
Final Improved Documents: [1, 5, 2, 3, 0]


Example 95
Sorted Documents: [7, 3, 1, 5, 6, 8, 4, 0, 2]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2]


Example 96
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 97
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 98
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 99
Sorted Documents: [0, 6, 1, 3, 4, 5, 7, 2, 8]
Removed Distracting Documents: [0, 6]
Final Improved Documents: [1, 3, 4, 5, 7, 2, 8]


Example 100
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 101
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 104
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 105
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 106
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 107
Sorted Documents: [8, 4, 0, 5, 2, 6, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 5, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 108
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 109
Sorted Documents: [6, 3, 0, 8, 5, 2, 4, 1, 7]
Removed Distracting Documents: [6, 3, 0, 8, 5, 2]
Final Improved Documents: [4, 1, 7]


Example 110
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3, 5]


Example 111
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 112
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 5, 3]


Example 114
Sorted Documents: [3, 5, 1, 8, 7, 0, 6, 4, 2]
Removed Distracting Documents: [3, 5, 1]
Final Improved Documents: [8, 7, 0, 6, 4, 2]


Example 115
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3]


Example 116
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 117
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 118
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 120
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 121
Sorted Documents: [4, 1, 2, 5, 6, 7, 8, 0, 3]
Removed Distracting Documents: [4, 1, 2]
Final Improved Documents: [5, 6, 7, 8, 0, 3]


Example 122
Sorted Documents: [0, 6, 2, 8, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [8, 4, 1, 7, 3, 5]


Example 123
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 125
Sorted Documents: [7, 1, 6, 3, 8, 4, 0, 2, 5]
Removed Distracting Documents: [7, 1, 6, 3]
Final Improved Documents: [8, 4, 0, 2, 5]


Example 126
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 128
Sorted Documents: [7, 0, 5, 1, 3, 4, 2, 6, 8]
Removed Distracting Documents: [7, 0, 5]
Final Improved Documents: [1, 3, 4, 2, 6, 8]


Example 129
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 130
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 134
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5]
Final Improved Documents: [8, 4, 0, 2, 6]


Example 135
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 136
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 138
Sorted Documents: [7, 4, 0, 5, 2, 6, 1, 8, 3]
Removed Distracting Documents: [7, 4, 0, 5, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 139
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 2, 8]


Example 140
Sorted Documents: [7, 1, 3, 4, 2, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 5, 6]


Example 141
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 142
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 143
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 144
Sorted Documents: [7, 2, 0, 4, 6, 8, 3, 1, 5]
Removed Distracting Documents: [7, 2, 0, 4, 6]
Final Improved Documents: [8, 3, 1, 5]


Example 145
Sorted Documents: [5, 0, 7, 2, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 146
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 148
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 149
Sorted Documents: [3, 5, 0, 6, 4, 8, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [8, 7, 1, 2]


Example 150
Sorted Documents: [5, 4, 1, 7, 3, 6, 8, 2, 0]
Removed Distracting Documents: [5, 4, 1, 7, 3, 6]
Final Improved Documents: [8, 2, 0]


Example 151
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 152
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:49,  6.15s/it] 22%|██▏       | 2/9 [00:12<00:42,  6.11s/it] 33%|███▎      | 3/9 [00:18<00:35,  5.99s/it] 44%|████▍     | 4/9 [00:25<00:32,  6.54s/it] 56%|█████▌    | 5/9 [00:32<00:27,  6.75s/it] 67%|██████▋   | 6/9 [00:39<00:20,  6.70s/it] 78%|███████▊  | 7/9 [00:45<00:13,  6.58s/it] 89%|████████▉ | 8/9 [00:51<00:06,  6.23s/it]100%|██████████| 9/9 [00:54<00:00,  5.29s/it]100%|██████████| 9/9 [00:54<00:00,  6.03s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1094.379335641861
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.65s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/10doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 5
num_documents_in_context: 10
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 7, 2, 5, 8, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [1, 6, 3, 9]


Example 1
Sorted Documents: [4, 6, 0, 2, 9, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 9, 5, 3]


Example 3
Sorted Documents: [5, 4, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [5, 4, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 4
Sorted Documents: [4, 5, 0, 7, 2, 9, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3]


Example 5
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 6
Sorted Documents: [4, 1, 6, 2, 8, 9, 5, 0, 3, 7]
Removed Distracting Documents: [4, 1, 6, 2]
Final Improved Documents: [8, 9, 5, 0, 3, 7]


Example 7
Sorted Documents: [3, 8, 0, 5, 4, 9, 1, 6, 2, 7]
Removed Distracting Documents: [3, 8, 0, 5, 4, 9]
Final Improved Documents: [1, 6, 2, 7]


Example 8
Sorted Documents: [3, 1, 5, 6, 9, 4, 0, 7, 2, 8]
Removed Distracting Documents: [3, 1, 5, 6]
Final Improved Documents: [9, 4, 0, 7, 2, 8]


Example 9
Sorted Documents: [8, 4, 1, 6, 3, 7, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [7, 0, 9, 2, 5]


Example 10
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 11
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 12
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 13
Sorted Documents: [9, 4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 14
Sorted Documents: [7, 0, 5, 2, 4, 9, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 9, 1, 8, 3, 6]


Example 15
Sorted Documents: [4, 5, 0, 8, 6, 2, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 9, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 17
Sorted Documents: [4, 6, 0, 8, 2, 9, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [9, 1, 7, 5, 3]


Example 18
Sorted Documents: [9, 2, 7, 8, 1, 3, 4, 5, 6, 0]
Removed Distracting Documents: [9, 2, 7, 8]
Final Improved Documents: [1, 3, 4, 5, 6, 0]


Example 19
Sorted Documents: [4, 6, 0, 2, 9, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 20
Sorted Documents: [4, 1, 7, 3, 9, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 7, 3, 9]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 21
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 23
Warning: No valid JSON found in LLM response.
[
            {
                "index": 783397,
                "score": 0.3
            },
            {
                "index": 5175835,
                "score": 0.7
            },
            {
                "index": 7148702,
                "score": 0.2
            },
            {
                "index": 9241858,
                "score": 0.5
            },
            {
                "index": 6656900,
                "score": 0.1
            },
            {
                "index": 20970909,
                "score": 0.8
            },
            {
                "index": 6656897,
                "score": 0.4
            },
            {
                "index": 10577120,
                "score": 0.6
            },
            {
                "index": 12581050,
                "score": 0.9
            },
            {
                "index": 5175841,
                "score": 0.5
Example 24
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 25
Error in processing LLM response: Expecting value: line 2 column 43 (char 44). Returning all documents by default.
Example 26
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 8]
Final Improved Documents: [7, 1, 9, 3]


Example 27
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 28
Warning: No valid JSON found in LLM response.
[
            { "index": 1, "score": 0.7 }, // Document 1: unlikely to contain the correct answer
            { "index": 2, "score": 0.3 }, // Document 2: unlikely to contain the correct answer
            { "index": 3, "score": 0.5 }, // Document 3: somewhat likely to contain the correct answer
            { "index": 4, "score": 0.1 }, // Document 4: very unlikely to contain the correct answer
            { "index": 5, "score": 0.8 }, // Document 5: somewhat likely to contain the correct answer
            { "index": 6, "score": 0.2 }, // Document 6: very unlikely to contain the correct answer
            { "index": 7, "score": 0.4 }, // Document 7: somewhat likely to contain the correct answer
            { "index": 8, "score": 0.6 }, // Document 8: very likely to contain the correct answer
            { "index": 9, "score": 0.9 }, // Document 9: very likely to contain the correct answer
            { "index": 10, "score": 0.1 } // Document 10: very unlikely to contain the correct
Example 29
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 30
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 31
Sorted Documents: [9, 8, 1, 7, 6, 5, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [4, 0, 2, 3]


Example 32
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 33
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 34
Sorted Documents: [9, 4, 1, 7, 3, 6, 0, 8, 2, 5]
Removed Distracting Documents: [9, 4, 1, 7, 3]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 35
Sorted Documents: [9, 8, 2, 7, 5, 1, 3, 4, 6, 0]
Removed Distracting Documents: [9, 8, 2, 7, 5]
Final Improved Documents: [1, 3, 4, 6, 0]


Example 36
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                document: {
                    "title": "Area codes 587 and 825",
                    "content": "Area codes 587 and 825 are telephone area codes that cover all of Alberta, Canada, in addition to the incumbent codes, southern Alberta's 403 and northern Alberta's 780."
                },
                "score": 0.8
            },
            {
                "index": 3,
                document: {
                    "title": "ZIP Codes",
                    "content": "Which are Washington, D.C. ZIP Codes, even if they are not located in Washington itself."
                },
                "score": 0.6
            },
            {
                "index": 4,
                document: {
                    "title": "Area code 785",
                    "content": "this point, area code 785 reaches its easternmost boundary with the current boundary for area code 913,"
                },
                "score": 0.5
            },
            {
Example 37
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 39
Sorted Documents: [9, 8, 1, 7, 6, 5, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [4, 0, 2, 3]


Example 40
Sorted Documents: [1, 3, 8, 5, 6, 4, 9, 0, 7, 2]
Removed Distracting Documents: [1, 3, 8, 5, 6]
Final Improved Documents: [4, 9, 0, 7, 2]


Example 41
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 42
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 44
Sorted Documents: [4, 0, 8, 2, 9, 6, 1, 7, 5, 3]
Removed Distracting Documents: [4, 0, 8, 2, 9]
Final Improved Documents: [6, 1, 7, 5, 3]


Example 45
Sorted Documents: [7, 6, 0, 5, 2, 8, 9, 4, 1, 3]
Removed Distracting Documents: [7, 6, 0, 5, 2]
Final Improved Documents: [8, 9, 4, 1, 3]


Example 46
Sorted Documents: [9, 8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [9, 8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 47
Sorted Documents: [3, 7, 0, 5, 9, 4, 8, 1, 6, 2]
Removed Distracting Documents: [3, 7, 0, 5, 9, 4, 8]
Final Improved Documents: [1, 6, 2]


Example 48
Sorted Documents: [2, 9, 5, 0, 7, 4, 6, 1, 8, 3]
Removed Distracting Documents: [2, 9, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 3]


Example 49
Warning: No valid JSON found in LLM response.
[
            {
                "index": 425425,
                "score": 0.7
            },
            {
                "index": 425421,
                "score": 0.6
            },
            {
                "index": 425497,
                "score": 0.4
            },
            {
                "index": 1107258,
                "score": 0.3
            },
            {
                "index": 3473114,
                "score": 0.2
            },
            {
                "index": 20971068,
                "score": 0.1
            },
            {
                "index": 12308970,
                "score": 0.5
            },
            {
                "index": 13204350,
                "score": 0.8
            },
            {
                "index": 425429,
                "score": 0.9
            },
            {
                "index": 2747589,
                "score": 0.6
            }
Example 50
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 53
Sorted Documents: [4, 0, 8, 2, 5, 9, 1, 7, 3, 6]
Removed Distracting Documents: [4, 0, 8, 2, 5, 9]
Final Improved Documents: [1, 7, 3, 6]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 6, 9]


Example 55
Sorted Documents: [5, 6, 0, 7, 2, 8, 1, 9, 3, 4]
Removed Distracting Documents: [5, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 9, 3, 4]


Example 56
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 57
Sorted Documents: [2, 6, 4, 8, 3, 7, 0, 9, 5, 1]
Removed Distracting Documents: [2, 6, 4, 8, 3]
Final Improved Documents: [7, 0, 9, 5, 1]


Example 58
Sorted Documents: [3, 9, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 9, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 59
Sorted Documents: [4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 61
Sorted Documents: [4, 9, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 62
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 63
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 64
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 3, 7]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 3, 7]


Example 65
Sorted Documents: [7, 2, 0, 4, 5, 3, 1, 9, 6, 8]
Removed Distracting Documents: [7, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 9, 6, 8]


Example 66
Sorted Documents: [2, 6, 4, 0, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [2, 6, 4, 0, 5, 9]
Final Improved Documents: [1, 8, 7, 3]


Example 67
Sorted Documents: [4, 1, 9, 7, 3, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 68
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 69
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 70
Sorted Documents: [9, 4, 1, 6, 3, 5, 0, 7, 2, 8]
Removed Distracting Documents: [9, 4, 1, 6, 3]
Final Improved Documents: [5, 0, 7, 2, 8]


Example 71
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 72
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 9, 3]


Example 73
Sorted Documents: [4, 6, 0, 9, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [7, 5, 1, 3, 4, 9, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [9, 2, 0, 6, 8]


Example 75
Sorted Documents: [4, 5, 0, 7, 2, 9, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3]


Example 76
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 9, 1, 8, 7, 3]


Example 78
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 79
Sorted Documents: [4, 0, 6, 2, 9, 7, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 5, 3]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 81
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 82
Sorted Documents: [9, 5, 0, 7, 2, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 83
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 84
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]


Example 85
Sorted Documents: [4, 0, 6, 2, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 9, 1, 8, 7, 3]


Example 86
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 87
Sorted Documents: [8, 7, 0, 5, 2, 4, 1, 9, 3, 6]
Removed Distracting Documents: [8, 7, 0, 5, 2]
Final Improved Documents: [4, 1, 9, 3, 6]


Example 88
Sorted Documents: [8, 4, 1, 7, 3, 6, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [6, 0, 9, 2, 5]


Example 89
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.8
         },
         {
            "index": 4,
            "score": 0.4
         },
         {
            "index": 5,
            "score": 0.6
         },
         {
            "index": 6,
            "score": 0.5
         },
         {
            "index": 7,
            "score": 0.4
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.1
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating the likelihood that the document is a distracting document for the given query. A score of 0 indicates a very high likelihood that the document is a distracting document,
Example 90
Sorted Documents: [4, 6, 0, 9, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 91
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 92
Sorted Documents: [7, 2, 9, 5, 1, 4, 8, 0, 3, 6]
Removed Distracting Documents: [7, 2, 9, 5]
Final Improved Documents: [1, 4, 8, 0, 3, 6]


Example 93
Sorted Documents: [7, 9, 3, 1, 5, 6, 4, 0, 2, 8]
Removed Distracting Documents: [7, 9, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 2, 8]


Example 94
Sorted Documents: [8, 9, 6, 5, 4, 7, 3, 2, 1, 0]
Removed Distracting Documents: [8, 9, 6, 5, 4]
Final Improved Documents: [7, 3, 2, 1, 0]


Example 95
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 96
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 98
Sorted Documents: [4, 9, 0, 6, 2, 7, 1, 5, 3, 8]
Removed Distracting Documents: [4, 9, 0, 6, 2, 7]
Final Improved Documents: [1, 5, 3, 8]


Example 99
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 100
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 101
Sorted Documents: [0, 9, 6, 2, 8, 5, 1, 7, 4, 3]
Removed Distracting Documents: [0, 9, 6, 2, 8]
Final Improved Documents: [5, 1, 7, 4, 3]


Example 102
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 103
Sorted Documents: [0, 4, 8, 2, 6, 1, 5, 9, 3, 7]
Removed Distracting Documents: [0, 4, 8, 2, 6]
Final Improved Documents: [1, 5, 9, 3, 7]


Example 104
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 105
Sorted Documents: [7, 0, 5, 2, 4, 9, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 9, 1, 8, 3, 6]


Example 106
Sorted Documents: [4, 0, 5, 2, 6, 1, 8, 7, 3, 9]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 8, 7, 3, 9]


Example 107
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 108
Sorted Documents: [4, 0, 7, 2, 5, 8, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [1, 6, 3, 9]


Example 109
Sorted Documents: [7, 8, 0, 3, 1, 4, 5, 9, 2, 6]
Removed Distracting Documents: [7, 8, 0, 3]
Final Improved Documents: [1, 4, 5, 9, 2, 6]


Example 110
Sorted Documents: [2, 5, 0, 8, 4, 9, 7, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 8, 4]
Final Improved Documents: [9, 7, 1, 6, 3]


Example 111
Sorted Documents: [2, 8, 5, 0, 7, 4, 6, 1, 9, 3]
Removed Distracting Documents: [2, 8, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 3]


Example 112
Sorted Documents: [6, 0, 8, 5, 2, 4, 1, 9, 7, 3]
Removed Distracting Documents: [6, 0, 8, 5, 2]
Final Improved Documents: [4, 1, 9, 7, 3]


Example 113
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 9, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 8]
Final Improved Documents: [4, 0, 9, 2, 6]


Example 114
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 115
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 116
Sorted Documents: [4, 1, 7, 3, 9, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 7, 3, 9]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 117
Sorted Documents: [0, 9, 6, 2, 8, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 9, 6, 2, 8]
Final Improved Documents: [4, 1, 7, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 119
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 120
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 121
Sorted Documents: [7, 4, 1, 6, 3, 5, 0, 9, 2, 8]
Removed Distracting Documents: [7, 4, 1, 6, 3]
Final Improved Documents: [5, 0, 9, 2, 8]


Example 122
Sorted Documents: [1, 3, 5, 7, 2, 6, 8, 9, 0, 4]
Removed Distracting Documents: [1, 3, 5, 7, 2, 6]
Final Improved Documents: [8, 9, 0, 4]


Example 123
Sorted Documents: [9, 4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 125
Sorted Documents: [8, 4, 1, 7, 3, 5, 0, 9, 2, 6]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [5, 0, 9, 2, 6]


Example 126
Sorted Documents: [9, 4, 0, 8, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [9, 4, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 128
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 129
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 130
Sorted Documents: [0, 8, 6, 2, 9, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 8, 6, 2, 9]
Final Improved Documents: [4, 1, 7, 3, 5]


Example 131
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 132
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 133
Sorted Documents: [0, 6, 2, 4, 8, 1, 7, 3, 5, 9]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [4, 8, 1, 7, 3, 5, 9]


Example 134
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 9, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 8]
Final Improved Documents: [4, 0, 9, 2, 6]


Example 135
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 136
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 138
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 9, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 8, 2]


Example 139
Sorted Documents: [4, 1, 6, 3, 9, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 6, 3, 9]
Final Improved Documents: [7, 0, 8, 2, 5]


Example 140
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 6, 9]


Example 141
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 142
Sorted Documents: [8, 4, 1, 6, 3, 7, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [7, 0, 9, 2, 5]


Example 143
Sorted Documents: [7, 3, 1, 5, 9, 4, 0, 8, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 9]
Final Improved Documents: [4, 0, 8, 2, 6]


Example 144
Sorted Documents: [6, 2, 0, 4, 8, 3, 1, 7, 9, 5]
Removed Distracting Documents: [6, 2, 0, 4, 8]
Final Improved Documents: [3, 1, 7, 9, 5]


Example 145
Sorted Documents: [4, 0, 6, 2, 8, 1, 5, 9, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2, 8]
Final Improved Documents: [1, 5, 9, 3, 7]


Example 146
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 147
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 148
Sorted Documents: [8, 3, 1, 5, 6, 4, 0, 9, 2, 7]
Removed Distracting Documents: [8, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 7]


Example 149
Sorted Documents: [9, 8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [9, 8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 150
Sorted Documents: [8, 4, 1, 6, 3, 9, 5, 0, 2, 7]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [9, 5, 0, 2, 7]


Example 151
Sorted Documents: [4, 5, 0, 8, 6, 2, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 9, 3]


Example 152
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 153
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 10
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:39,  4.91s/it] 22%|██▏       | 2/9 [00:12<00:47,  6.74s/it] 33%|███▎      | 3/9 [00:21<00:44,  7.48s/it] 44%|████▍     | 4/9 [00:26<00:32,  6.49s/it] 56%|█████▌    | 5/9 [00:34<00:29,  7.28s/it] 67%|██████▋   | 6/9 [00:41<00:20,  6.93s/it] 78%|███████▊  | 7/9 [00:47<00:13,  6.73s/it] 89%|████████▉ | 8/9 [00:53<00:06,  6.56s/it]100%|██████████| 9/9 [00:55<00:00,  5.20s/it]100%|██████████| 9/9 [00:55<00:00,  6.22s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1151.0549206733704
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/11doc
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 5
num_documents_in_context: 11
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.9
         },
         {
            "index": 6,
            "score": 0.5
         },
         {
            "index": 7,
            "score": 0.7
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 9,
            "score": 0.5
         },
         {
            "index": 10,
            "score": 0.1
         },
         {
            "index": 11,
            "score": 0.9
         }

Explanation:
The given documents are highly relevant to the query but are unlikely to contain the correct answer. Document 1 has a low score because it does not provide any information related to the query. Document 2 has a moderate score because it provides some information related to the query,
Example 1
Sorted Documents: [4, 9, 0, 7, 2, 10, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 9, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 3
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 4
Sorted Documents: [9, 8, 1, 7, 6, 5, 10, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [10, 4, 0, 2, 3]


Example 5
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 6
Sorted Documents: [4, 1, 6, 2, 8, 9, 10, 5, 0, 3, 7]
Removed Distracting Documents: [4, 1, 6, 2]
Final Improved Documents: [8, 9, 10, 5, 0, 3, 7]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 8
Sorted Documents: [9, 8, 1, 7, 6, 5, 10, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [10, 4, 0, 2, 3]


Example 9
Sorted Documents: [3, 10, 5, 0, 7, 4, 6, 1, 9, 8, 2]
Removed Distracting Documents: [3, 10, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 8, 2]


Example 10
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.2
         },
         {
            "index": 5,
            "score": 0.4
         },
         {
            "index": 6,
            "score": 0.6
         },
         {
            "index": 7,
            "score": 0.1
         },
         {
            "index": 8,
            "score": 0.8
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.5
         },
         {
            "index": 11,
            "score": 0.7
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating how likely it is to contain the correct answer. A score of 0 indicates that the document is unlikely to contain the correct answer, while a score of 1 indicates that it is very likely
Example 11
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4, 10]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 12
Sorted Documents: [5, 2, 0, 4, 7, 10, 3, 1, 9, 8, 6]
Removed Distracting Documents: [5, 2, 0, 4, 7]
Final Improved Documents: [10, 3, 1, 9, 8, 6]


Example 13
Sorted Documents: [10, 4, 0, 7, 2, 9, 6, 1, 8, 3, 5]
Removed Distracting Documents: [10, 4, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 14
Sorted Documents: [0, 6, 2, 8, 10, 4, 9, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2, 8]
Final Improved Documents: [10, 4, 9, 1, 7, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 8, 9, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 17
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 18
Sorted Documents: [0, 2, 6, 1, 3, 4, 5, 7, 8, 9, 10]
Removed Distracting Documents: [0, 2, 6]
Final Improved Documents: [1, 3, 4, 5, 7, 8, 9, 10]


Example 19
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 20
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 21
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 22
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 23
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3, 10]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 24
Sorted Documents: [9, 7, 0, 5, 2, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [9, 7, 0, 5, 2]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 25
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.8
         },
         {
            "index": 6,
            "score": 0.4
         },
         {
            "index": 7,
            "score": 0.6
         },
         {
            "index": 8,
            "score": 0.2
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.9
         },
         {
            "index": 11,
            "score": 0.5
         }

Explanation:

* Document 1: Score = 0.7. This document contains information about Catherine Earnshaw, who is a central character in the novel, but does not provide any insight into the query. Therefore, the score is set to 0.7
Example 26
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3, 10]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3, 10]


Example 27
Sorted Documents: [4, 10, 6, 0, 8, 2, 9, 7, 1, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2, 9]
Final Improved Documents: [7, 1, 5, 3]


Example 28
Warning: No valid JSON found in LLM response.
{
            "document_1": 0.7,
            "document_2": 0.3,
            "document_3": 0.5,
            "document_4": 0.2,
            "document_5": 0.4,
            "document_6": 0.1,
            "document_7": 0.8,
            "document_8": 0.6,
            "document_9": 0.9,
            "document_10": 0.3,
            "document_11": 0.4
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating how likely it is to contain distracting information related to the query. A score of 0 indicates very likely that the document contains distracting information, while a score of 1 indicates very unlikely.
* Documents 1, 2, and 4 are likely to contain distracting information related to the query, with scores of 0.7, 0.3, and 0.2, respectively.
* Documents 3, 5, 6, 8, and 10 are less likely to contain distracting information related to the query, with scores of 0.5, 0.4, 0.1, 0.6, and 0.3, respectively.
Example 29
Sorted Documents: [7, 3, 1, 9, 5, 6, 4, 0, 10, 2, 8]
Removed Distracting Documents: [7, 3, 1, 9, 5, 6]
Final Improved Documents: [4, 0, 10, 2, 8]


Example 30
Sorted Documents: [7, 5, 0, 2, 4, 10, 1, 9, 3, 6, 8]
Removed Distracting Documents: [7, 5, 0, 2, 4]
Final Improved Documents: [10, 1, 9, 3, 6, 8]


Example 31
Sorted Documents: [4, 1, 7, 3, 10, 6, 0, 8, 2, 9, 5]
Removed Distracting Documents: [4, 1, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 9, 5]


Example 32
Sorted Documents: [7, 5, 1, 9, 3, 10, 4, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 9, 3, 10, 4]
Final Improved Documents: [2, 0, 6, 8]


Example 33
Sorted Documents: [5, 0, 10, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 10, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 34
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 35
Sorted Documents: [2, 9, 8, 5, 10, 1, 3, 4, 7, 6, 0]
Removed Distracting Documents: [2, 9, 8, 5, 10]
Final Improved Documents: [1, 3, 4, 7, 6, 0]


Example 36
Sorted Documents: [0, 1, 2, 3, 4, 9, 10, 5, 6, 7, 8]
Removed Distracting Documents: [0, 1, 2, 3, 4]
Final Improved Documents: [9, 10, 5, 6, 7, 8]


Example 37
Sorted Documents: [3, 5, 7, 1, 9, 10, 6, 0, 8, 4, 2]
Removed Distracting Documents: [3, 5, 7, 1, 9]
Final Improved Documents: [10, 6, 0, 8, 4, 2]


Example 38
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 39
Sorted Documents: [8, 2, 9, 1, 3, 4, 5, 7, 10, 0, 6]
Removed Distracting Documents: [8, 2, 9]
Final Improved Documents: [1, 3, 4, 5, 7, 10, 0, 6]


Example 40
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 41
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 42
Sorted Documents: [4, 9, 5, 0, 7, 2, 10, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 44
Sorted Documents: [5, 4, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2, 10]
Final Improved Documents: [7, 1, 8, 9, 3]


Example 45
Sorted Documents: [8, 4, 1, 7, 3, 10, 6, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [10, 6, 0, 9, 2, 5]


Example 46
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 47
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 48
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 49
Sorted Documents: [2, 10, 8, 1, 4, 6, 0, 7, 3, 5, 9]
Removed Distracting Documents: [2, 10, 8]
Final Improved Documents: [1, 4, 6, 0, 7, 3, 5, 9]


Example 50
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2, 10]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 53
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 55
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 3, 4]
Removed Distracting Documents: [9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 3, 4]


Example 56
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.2
         },
         {
            "index": 5,
            "score": 0.8
         },
         {
            "index": 6,
            "score": 0.1
         },
         {
            "index": 7,
            "score": 0.9
         },
         {
            "index": 8,
            "score": 0.5
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.7
         },
         {
            "index": 11,
            "score": 0.6
         }

Explanation:

* Document 1 is unlikely to contain the correct answer because it is focused on the global peace index and does not provide any information related to the query. Therefore, the score is set to 0.
* Document 2 is unlikely to contain the correct answer because
Example 57
Sorted Documents: [4, 9, 0, 7, 2, 10, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 9, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 5, 3]


Example 58
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 59
Sorted Documents: [10, 4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [10, 4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 60
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 61
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 9, 8, 3]


Example 63
Sorted Documents: [4, 1, 6, 3, 9, 10, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 6, 3, 9]
Final Improved Documents: [10, 7, 0, 8, 2, 5]


Example 64
Sorted Documents: [8, 4, 0, 6, 2, 10, 5, 1, 9, 3, 7]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [10, 5, 1, 9, 3, 7]


Example 65
Sorted Documents: [4, 6, 0, 2, 9, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 66
Sorted Documents: [2, 4, 0, 6, 3, 10, 5, 1, 7, 8, 9]
Removed Distracting Documents: [2, 4, 0, 6, 3]
Final Improved Documents: [10, 5, 1, 7, 8, 9]


Example 67
Sorted Documents: [6, 5, 1, 7, 3, 8, 4, 9, 10, 2, 0]
Removed Distracting Documents: [6, 5, 1, 7, 3, 8, 4, 9]
Final Improved Documents: [10, 2, 0]


Example 68
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 69
Sorted Documents: [4, 0, 7, 2, 5, 9, 10, 1, 8, 3, 6]
Removed Distracting Documents: [4, 0, 7, 2, 5, 9]
Final Improved Documents: [10, 1, 8, 3, 6]


Example 70
Sorted Documents: [0, 6, 2, 10, 4, 8, 1, 7, 3, 9, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [10, 4, 8, 1, 7, 3, 9, 5]


Example 71
Sorted Documents: [0, 1, 4, 5, 2, 9, 3, 8, 6, 10, 7]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 4, 5, 2, 9, 3, 8, 6, 10, 7]


Example 72
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 73
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2, 10]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [2, 0, 4, 5, 10, 3, 6, 1, 7, 8, 9]
Removed Distracting Documents: [2, 0, 4, 5]
Final Improved Documents: [10, 3, 6, 1, 7, 8, 9]


Example 75
Sorted Documents: [2, 5, 0, 8, 4, 10, 7, 1, 9, 6, 3]
Removed Distracting Documents: [2, 5, 0, 8, 4]
Final Improved Documents: [10, 7, 1, 9, 6, 3]


Example 76
Sorted Documents: [2, 5, 0, 7, 4, 10, 8, 1, 9, 6, 3]
Removed Distracting Documents: [2, 5, 0, 7, 4]
Final Improved Documents: [10, 8, 1, 9, 6, 3]


Example 77
Sorted Documents: [9, 4, 0, 6, 2, 10, 5, 1, 8, 7, 3]
Removed Distracting Documents: [9, 4, 0, 6, 2]
Final Improved Documents: [10, 5, 1, 8, 7, 3]


Example 78
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4, 10]
Final Improved Documents: [2, 9, 0, 8, 5, 6]


Example 79
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 81
Sorted Documents: [4, 0, 6, 2, 9, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 7, 1, 8, 3, 5]


Example 82
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 83
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 84
Sorted Documents: [4, 0, 10, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 10, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 85
Warning: No valid JSON found in LLM response.
{
            "document_1": 0.7,
            "document_2": 0.3,
            "document_3": 0.5,
            "document_4": 0.2,
            "document_5": 0.8,
            "document_6": 0.4,
            "document_7": 0.6,
            "document_8": 0.1,
            "document_9": 0.9,
            "document_10": 0.5,
            "document_11": 0.9
         }

Explanation:

* Document 1 is likely to be a distracting document for the query "what is the line in the middle of a time zone that in theory determines the time of that zone". It contains information on time zones and their boundaries, but does not directly address the query. Score: 0.7
* Document 2 is unlikely to be a distracting document for the query. It contains information on time zones and their boundaries, but also discusses the reasons for time zone boundaries being located far to the west of their meridians. Score: 0.3
* Document 3 is likely to be a distracting document for the query. It contains information on time zone boundaries and their reasons, but does not directly address the query. Score: 0.5
* Document 4
Example 86
Sorted Documents: [8, 7, 0, 9, 5, 1, 3, 4, 6, 10, 2]
Removed Distracting Documents: [8, 7, 0, 9, 5]
Final Improved Documents: [1, 3, 4, 6, 10, 2]


Example 87
Sorted Documents: [7, 0, 5, 2, 9, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2, 9]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 88
Sorted Documents: [7, 5, 1, 3, 10, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 10, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 89
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.9
         },
         {
            "index": 6,
            "score": 0.8
         },
         {
            "index": 7,
            "score": 0.4
         },
         {
            "index": 8,
            "score": 0.6
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.3
         },
         {
            "index": 11,
            "score": 0.1
         }

Explanation:

* Document 1 has a low score (0.7) because it does not mention the Passion of Christ directly, instead focusing on the title "The Passion of the Christ".
* Document 2 has a moderate score (0.3)
Example 90
Sorted Documents: [4, 0, 7, 2, 5, 8, 10, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [10, 1, 6, 3, 9]


Example 91
Sorted Documents: [6, 1, 3, 4, 10, 2, 9, 0, 7, 5, 8]
Removed Distracting Documents: [6, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 7, 5, 8]


Example 92
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 8, 5, 6]


Example 93
Sorted Documents: [1, 6, 4, 10, 2, 8, 0, 7, 3, 5, 9]
Removed Distracting Documents: [1, 6, 4, 10]
Final Improved Documents: [2, 8, 0, 7, 3, 5, 9]


Example 94
Warning: No valid JSON found in LLM response.
{
            "index": 3,
            "score": 0.7
         },
         {
            "index": 1,
            "score": 0.3
         },
         {
            "index": 7,
            "score": 0.5
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.8
         },
         {
            "index": 11,
            "score": 0.4
         },
         {
            "index": 6,
            "score": 0.6
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 5,
            "score": 0.5
         }
      ]
Example 95
Sorted Documents: [7, 3, 1, 10, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 10, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 96
Sorted Documents: [0, 2, 5, 1, 3, 4, 10, 6, 7, 8, 9]
Removed Distracting Documents: [0, 2, 5]
Final Improved Documents: [1, 3, 4, 10, 6, 7, 8, 9]


Example 97
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 98
Sorted Documents: [10, 3, 1, 9, 5, 7, 4, 0, 8, 2, 6]
Removed Distracting Documents: [10, 3, 1, 9, 5, 7]
Final Improved Documents: [4, 0, 8, 2, 6]


Example 99
Sorted Documents: [7, 0, 9, 5, 1, 3, 4, 8, 2, 10, 6]
Removed Distracting Documents: [7, 0, 9, 5]
Final Improved Documents: [1, 3, 4, 8, 2, 10, 6]


Example 100
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 101
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 4, 3]


Example 102
Sorted Documents: [8, 4, 0, 5, 2, 10, 6, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 5, 2, 10]
Final Improved Documents: [6, 1, 9, 7, 3]


Example 103
Sorted Documents: [10, 5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [10, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 104
Sorted Documents: [4, 10, 5, 0, 9, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 9, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 105
Sorted Documents: [7, 0, 5, 2, 9, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2, 9]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 106
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 9, 6, 8]


Example 107
Sorted Documents: [8, 0, 10, 5, 1, 3, 4, 7, 9, 2, 6]
Removed Distracting Documents: [8, 0, 10, 5]
Final Improved Documents: [1, 3, 4, 7, 9, 2, 6]


Example 108
Sorted Documents: [10, 4, 0, 6, 2, 9, 5, 1, 8, 3, 7]
Removed Distracting Documents: [10, 4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 3, 7]


Example 109
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 110
Sorted Documents: [9, 4, 0, 7, 2, 10, 6, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 3, 5]


Example 111
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 112
Sorted Documents: [3, 0, 5, 9, 4, 8, 1, 6, 10, 2, 7]
Removed Distracting Documents: [3, 0, 5, 9, 4, 8]
Final Improved Documents: [1, 6, 10, 2, 7]


Example 113
Sorted Documents: [2, 4, 0, 6, 8, 10, 5, 1, 9, 7, 3]
Removed Distracting Documents: [2, 4, 0, 6, 8]
Final Improved Documents: [10, 5, 1, 9, 7, 3]


Example 114
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 115
Sorted Documents: [4, 6, 0, 8, 2, 5, 7, 10, 9, 1, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [5, 7, 10, 9, 1, 3]


Example 116
Sorted Documents: [6, 10, 0, 8, 1, 4, 5, 7, 2, 9, 3]
Removed Distracting Documents: [6, 10, 0, 8]
Final Improved Documents: [1, 4, 5, 7, 2, 9, 3]


Example 117
Sorted Documents: [4, 1, 8, 2, 9, 10, 6, 0, 7, 3, 5]
Removed Distracting Documents: [4, 1, 8, 2, 9]
Final Improved Documents: [10, 6, 0, 7, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 119
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 120
Sorted Documents: [7, 3, 1, 5, 9, 10, 4, 0, 8, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 9]
Final Improved Documents: [10, 4, 0, 8, 2, 6]


Example 121
Sorted Documents: [7, 5, 1, 10, 3, 9, 4, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 10, 3, 9, 4]
Final Improved Documents: [2, 0, 6, 8]


Example 122
Sorted Documents: [7, 6, 5, 1, 4, 8, 10, 3, 2, 0, 9]
Removed Distracting Documents: [7, 6, 5]
Final Improved Documents: [1, 4, 8, 10, 3, 2, 0, 9]


Example 123
Sorted Documents: [9, 4, 0, 6, 2, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 6, 2, 10]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 125
Sorted Documents: [6, 0, 4, 10, 2, 8, 1, 7, 3, 9, 5]
Removed Distracting Documents: [6, 0, 4, 10]
Final Improved Documents: [2, 8, 1, 7, 3, 9, 5]


Example 126
Sorted Documents: [9, 7, 0, 5, 2, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [9, 7, 0, 5, 2, 10]
Final Improved Documents: [4, 1, 8, 3, 6]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 128
Sorted Documents: [5, 1, 8, 3, 4, 7, 10, 2, 0, 9, 6]
Removed Distracting Documents: [5, 1, 8, 3, 4, 7]
Final Improved Documents: [10, 2, 0, 9, 6]


Example 129
Sorted Documents: [7, 5, 1, 3, 4, 2, 10, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 10, 0, 9, 6, 8]


Example 130
Sorted Documents: [4, 6, 0, 2, 9, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 132
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 133
Sorted Documents: [0, 10, 1, 5, 9, 2, 6, 3, 7, 4, 8]
Removed Distracting Documents: [0]
Final Improved Documents: [10, 1, 5, 9, 2, 6, 3, 7, 4, 8]


Example 134
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 8, 5, 6]


Example 135
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 136
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4, 10]
Final Improved Documents: [2, 9, 0, 8, 5, 6]


Example 137
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 138
Sorted Documents: [3, 8, 0, 5, 10, 4, 9, 1, 6, 2, 7]
Removed Distracting Documents: [3, 8, 0, 5, 10, 4, 9]
Final Improved Documents: [1, 6, 2, 7]


Example 139
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 8, 9, 3]


Example 140
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 141
Sorted Documents: [4, 0, 6, 2, 9, 10, 5, 1, 8, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 5, 1, 8, 3, 7]


Example 142
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 143
Sorted Documents: [4, 0, 6, 2, 9, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 7, 1, 8, 3, 5]


Example 144
Sorted Documents: [6, 2, 0, 4, 8, 10, 3, 1, 7, 9, 5]
Removed Distracting Documents: [6, 2, 0, 4, 8]
Final Improved Documents: [10, 3, 1, 7, 9, 5]


Example 145
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 146
Sorted Documents: [8, 7, 6, 5, 4, 10, 3, 2, 1, 0, 9]
Removed Distracting Documents: [8, 7, 6, 5, 4]
Final Improved Documents: [10, 3, 2, 1, 0, 9]


Example 147
Sorted Documents: [4, 0, 6, 2, 9, 7, 1, 8, 3, 10, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3, 10, 5]


Example 148
Sorted Documents: [4, 1, 9, 6, 3, 10, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 6, 3, 10]
Final Improved Documents: [7, 0, 8, 2, 5]


Example 149
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 150
Sorted Documents: [4, 5, 0, 8, 6, 2, 10, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 3]


Example 151
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 152
Sorted Documents: [4, 5, 0, 7, 2, 9, 10, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [10, 6, 1, 8, 3]


Example 153
Sorted Documents: [4, 0, 7, 2, 5, 8, 10, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [10, 1, 6, 3, 9]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 11
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:08<01:05,  8.21s/it] 22%|██▏       | 2/9 [00:16<00:59,  8.48s/it] 33%|███▎      | 3/9 [00:25<00:51,  8.66s/it] 44%|████▍     | 4/9 [00:33<00:40,  8.17s/it] 56%|█████▌    | 5/9 [00:40<00:31,  7.92s/it] 67%|██████▋   | 6/9 [00:46<00:21,  7.22s/it] 78%|███████▊  | 7/9 [00:53<00:14,  7.28s/it] 89%|████████▉ | 8/9 [00:59<00:06,  6.60s/it]100%|██████████| 9/9 [01:01<00:00,  5.25s/it]100%|██████████| 9/9 [01:01<00:00,  6.82s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1233.6994614601135
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.65s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.0
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6, 2]
Final Improved Documents: []


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5, 3]
Final Improved Documents: []


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1, 3]
Final Improved Documents: []


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3, 5]
Final Improved Documents: []


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 4, 6]
Removed Distracting Documents: [3, 1, 5, 0, 2, 4]
Final Improved Documents: [6]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5, 3]
Final Improved Documents: []


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 92
Sorted Documents: [0, 1, 2, 3, 4, 5, 6]
Removed Distracting Documents: [0, 1, 2, 3, 4, 5]
Final Improved Documents: [6]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 99
Sorted Documents: [0, 4, 2, 6, 1, 3, 5]
Removed Distracting Documents: [0, 4, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 108
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5, 3, 6]
Final Improved Documents: []


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 121
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3, 6]
Final Improved Documents: []


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 3, 6]
Removed Distracting Documents: [4, 5, 0, 2, 1, 3]
Final Improved Documents: [6]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1, 5]
Final Improved Documents: []


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5, 2]
Final Improved Documents: []


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:43,  5.49s/it] 22%|██▏       | 2/9 [00:09<00:30,  4.38s/it] 33%|███▎      | 3/9 [00:12<00:24,  4.02s/it] 44%|████▍     | 4/9 [00:16<00:19,  3.96s/it] 56%|█████▌    | 5/9 [00:22<00:19,  4.76s/it] 67%|██████▋   | 6/9 [00:27<00:14,  4.74s/it] 78%|███████▊  | 7/9 [00:31<00:09,  4.57s/it] 89%|████████▉ | 8/9 [00:35<00:04,  4.42s/it]100%|██████████| 9/9 [00:39<00:00,  4.15s/it]100%|██████████| 9/9 [00:39<00:00,  4.37s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  828.7500805854797
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_1
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.1
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6, 2]
Final Improved Documents: []


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5, 3]
Final Improved Documents: []


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1, 3]
Final Improved Documents: []


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3, 5]
Final Improved Documents: []


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 4, 6]
Removed Distracting Documents: [3, 1, 5, 0, 2, 4]
Final Improved Documents: [6]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5, 3]
Final Improved Documents: []


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 92
Sorted Documents: [0, 1, 2, 3, 6, 4, 5]
Removed Distracting Documents: [0, 1, 2, 3]
Final Improved Documents: [6, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 99
Sorted Documents: [0, 4, 2, 6, 1, 3, 5]
Removed Distracting Documents: [0, 4, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 108
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5, 3, 6]
Final Improved Documents: []


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 121
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3, 6]
Final Improved Documents: []


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 3, 6]
Removed Distracting Documents: [4, 5, 0, 2, 1, 3]
Final Improved Documents: [6]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1, 5]
Final Improved Documents: []


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5, 2]
Final Improved Documents: []


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:44,  5.54s/it] 22%|██▏       | 2/9 [00:09<00:30,  4.41s/it] 33%|███▎      | 3/9 [00:12<00:24,  4.04s/it] 44%|████▍     | 4/9 [00:16<00:19,  3.98s/it] 56%|█████▌    | 5/9 [00:22<00:19,  4.77s/it] 67%|██████▋   | 6/9 [00:27<00:14,  4.79s/it] 78%|███████▊  | 7/9 [00:31<00:09,  4.61s/it] 89%|████████▉ | 8/9 [00:36<00:04,  4.45s/it]100%|██████████| 9/9 [00:39<00:00,  4.17s/it]100%|██████████| 9/9 [00:39<00:00,  4.40s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  826.6019859313965
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.81s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.85s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_2
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.2
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6]
Final Improved Documents: [3]


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6]
Final Improved Documents: [2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4]
Final Improved Documents: [6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6]
Final Improved Documents: [3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5]
Final Improved Documents: [3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1]
Final Improved Documents: [3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3]
Final Improved Documents: [5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6]
Final Improved Documents: [3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 6, 4]
Removed Distracting Documents: [3, 1, 5, 0, 2]
Final Improved Documents: [6, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5]
Final Improved Documents: [3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4]
Final Improved Documents: [3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6]
Final Improved Documents: [3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 92
Sorted Documents: [0, 1, 2, 3, 6, 4, 5]
Removed Distracting Documents: [0, 1, 2, 3]
Final Improved Documents: [6, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 99
Sorted Documents: [0, 4, 2, 1, 3, 5, 6]
Removed Distracting Documents: [0, 4, 2]
Final Improved Documents: [1, 3, 5, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3]
Final Improved Documents: [5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 108
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5]
Final Improved Documents: [3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 121
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3]
Final Improved Documents: [5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4]
Final Improved Documents: [6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3]
Final Improved Documents: [6]


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4]
Final Improved Documents: [3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1]
Final Improved Documents: [5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5]
Final Improved Documents: [2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:44,  5.51s/it] 22%|██▏       | 2/9 [00:10<00:35,  5.07s/it] 33%|███▎      | 3/9 [00:14<00:27,  4.56s/it] 44%|████▍     | 4/9 [00:18<00:22,  4.55s/it] 56%|█████▌    | 5/9 [00:24<00:20,  5.10s/it] 67%|██████▋   | 6/9 [00:30<00:15,  5.15s/it] 78%|███████▊  | 7/9 [00:34<00:09,  4.96s/it] 89%|████████▉ | 8/9 [00:39<00:04,  4.85s/it]100%|██████████| 9/9 [00:42<00:00,  4.45s/it]100%|██████████| 9/9 [00:42<00:00,  4.77s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  836.3723950386047
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.72s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_3
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.3
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1]
Final Improved Documents: [6, 3]


Example 1
Sorted Documents: [6, 0, 4, 2, 1, 3, 5]
Removed Distracting Documents: [6, 0, 4, 2]
Final Improved Documents: [1, 3, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1]
Final Improved Documents: [6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1]
Final Improved Documents: [4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1]
Final Improved Documents: [6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1]
Final Improved Documents: [6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3]
Final Improved Documents: [1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1]
Final Improved Documents: [3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6]
Final Improved Documents: [3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1]
Final Improved Documents: [6]


Example 71
Sorted Documents: [3, 1, 5, 0, 6, 2, 4]
Removed Distracting Documents: [3, 1, 5, 0]
Final Improved Documents: [6, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5]
Final Improved Documents: [3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1]
Final Improved Documents: [4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 92
Sorted Documents: [0, 1, 2, 6, 3, 4, 5]
Removed Distracting Documents: [0, 1, 2]
Final Improved Documents: [6, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 99
Sorted Documents: [0, 4, 2, 1, 3, 5, 6]
Removed Distracting Documents: [0, 4, 2]
Final Improved Documents: [1, 3, 5, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 108
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5]
Final Improved Documents: [3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 121
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1]
Final Improved Documents: [4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1]
Final Improved Documents: [3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 138
Sorted Documents: [5, 4, 2, 0, 1, 3, 6]
Removed Distracting Documents: [5, 4, 2, 0]
Final Improved Documents: [1, 3, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1]
Final Improved Documents: [6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1]
Final Improved Documents: [4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1]
Final Improved Documents: [5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1]
Final Improved Documents: [5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:47,  5.93s/it] 22%|██▏       | 2/9 [00:10<00:36,  5.24s/it] 33%|███▎      | 3/9 [00:15<00:29,  4.87s/it] 44%|████▍     | 4/9 [00:20<00:24,  4.95s/it] 56%|█████▌    | 5/9 [00:26<00:21,  5.40s/it] 67%|██████▋   | 6/9 [00:32<00:16,  5.49s/it] 78%|███████▊  | 7/9 [00:34<00:09,  4.60s/it] 89%|████████▉ | 8/9 [00:39<00:04,  4.61s/it]100%|██████████| 9/9 [00:43<00:00,  4.33s/it]100%|██████████| 9/9 [00:43<00:00,  4.80s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  833.7841944694519
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.61s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_4
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.4
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5]
Final Improved Documents: [1, 6, 3]


Example 1
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4]
Final Improved Documents: [1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5]
Final Improved Documents: [1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3]
Final Improved Documents: [1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6]
Final Improved Documents: [1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5]
Final Improved Documents: [3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6]
Final Improved Documents: [1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6]
Final Improved Documents: [1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6]
Final Improved Documents: [1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6]
Final Improved Documents: [1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4]
Final Improved Documents: [1, 6]


Example 71
Sorted Documents: [3, 1, 5, 6, 0, 2, 4]
Removed Distracting Documents: [3, 1, 5]
Final Improved Documents: [6, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6]
Final Improved Documents: [1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3]
Final Improved Documents: [1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [0, 1, 2, 6, 3, 4, 5]
Removed Distracting Documents: [0, 1, 2]
Final Improved Documents: [6, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6]
Final Improved Documents: [1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4]
Final Improved Documents: [1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6]
Final Improved Documents: [1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6]
Final Improved Documents: [1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3]
Final Improved Documents: [1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6]
Final Improved Documents: [1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3]
Final Improved Documents: [1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5]
Final Improved Documents: [1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6]
Final Improved Documents: [1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:38,  4.81s/it] 22%|██▏       | 2/9 [00:09<00:35,  5.01s/it] 33%|███▎      | 3/9 [00:12<00:24,  4.00s/it] 44%|████▍     | 4/9 [00:18<00:23,  4.63s/it] 56%|█████▌    | 5/9 [00:24<00:20,  5.18s/it] 67%|██████▋   | 6/9 [00:29<00:15,  5.08s/it] 78%|███████▊  | 7/9 [00:34<00:10,  5.14s/it] 89%|████████▉ | 8/9 [00:38<00:04,  4.73s/it]100%|██████████| 9/9 [00:40<00:00,  3.96s/it]100%|██████████| 9/9 [00:40<00:00,  4.54s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  836.3423545360565
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.64s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_5
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1, 6]


Example 71
Sorted Documents: [3, 1, 6, 5, 0, 2, 4]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [6, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:38,  4.83s/it] 22%|██▏       | 2/9 [00:10<00:35,  5.13s/it] 33%|███▎      | 3/9 [00:15<00:30,  5.11s/it] 44%|████▍     | 4/9 [00:21<00:26,  5.39s/it] 56%|█████▌    | 5/9 [00:27<00:22,  5.67s/it] 67%|██████▋   | 6/9 [00:31<00:15,  5.15s/it] 78%|███████▊  | 7/9 [00:37<00:10,  5.37s/it] 89%|████████▉ | 8/9 [00:41<00:04,  4.91s/it]100%|██████████| 9/9 [00:44<00:00,  4.35s/it]100%|██████████| 9/9 [00:44<00:00,  4.92s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  837.7126722335815
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.58s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.71s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_6
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.6
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 1, 3, 4, 2, 5]
Removed Distracting Documents: [6, 0]
Final Improved Documents: [1, 3, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5]
Final Improved Documents: [2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6]
Final Improved Documents: [2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 4, 1, 6]


Example 71
Sorted Documents: [3, 6, 1, 5, 0, 2, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2]
Final Improved Documents: [4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 99
Sorted Documents: [0, 1, 3, 5, 4, 2, 6]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 5, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 108
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 121
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5]
Final Improved Documents: [2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [6, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 138
Sorted Documents: [5, 4, 1, 3, 2, 0, 6]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [1, 3, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0]
Final Improved Documents: [4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:37,  4.71s/it] 22%|██▏       | 2/9 [00:10<00:36,  5.16s/it] 33%|███▎      | 3/9 [00:14<00:29,  4.85s/it] 44%|████▍     | 4/9 [00:20<00:27,  5.43s/it] 56%|█████▌    | 5/9 [00:27<00:22,  5.70s/it] 67%|██████▋   | 6/9 [00:33<00:17,  5.85s/it] 78%|███████▊  | 7/9 [00:39<00:12,  6.00s/it] 89%|████████▉ | 8/9 [00:44<00:05,  5.62s/it]100%|██████████| 9/9 [00:47<00:00,  4.92s/it]100%|██████████| 9/9 [00:47<00:00,  5.32s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  847.054206609726
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_7
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.7
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 1, 3, 4, 2, 5]
Removed Distracting Documents: [6, 0]
Final Improved Documents: [1, 3, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0]
Final Improved Documents: [5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [5, 2, 4, 1, 6]


Example 71
Sorted Documents: [3, 6, 1, 5, 0, 2, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0]
Final Improved Documents: [2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 92
Sorted Documents: [0, 6, 1, 2, 3, 4, 5]
Removed Distracting Documents: [0]
Final Improved Documents: [6, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 99
Sorted Documents: [0, 1, 3, 5, 4, 2, 6]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 5, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 108
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 121
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0]
Final Improved Documents: [5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [6, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 138
Sorted Documents: [5, 4, 1, 3, 2, 0, 6]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [1, 3, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0]
Final Improved Documents: [4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:38,  4.75s/it] 22%|██▏       | 2/9 [00:10<00:36,  5.23s/it] 33%|███▎      | 3/9 [00:15<00:32,  5.37s/it] 44%|████▍     | 4/9 [00:22<00:28,  5.76s/it] 56%|█████▌    | 5/9 [00:28<00:23,  5.97s/it] 67%|██████▋   | 6/9 [00:35<00:18,  6.19s/it] 78%|███████▊  | 7/9 [00:42<00:12,  6.40s/it] 89%|████████▉ | 8/9 [00:47<00:06,  6.04s/it]100%|██████████| 9/9 [00:49<00:00,  4.95s/it]100%|██████████| 9/9 [00:49<00:00,  5.54s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  847.913506269455
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_8
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.8
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 5, 1, 6, 3]


Example 1
Sorted Documents: [6, 1, 3, 0, 4, 2, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [1, 3, 0, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3]
Final Improved Documents: [0, 5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3]
Final Improved Documents: [0, 2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 4, 1, 6]


Example 71
Sorted Documents: [3, 6, 1, 5, 0, 2, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5]
Final Improved Documents: [0, 2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 92
Sorted Documents: [0, 6, 1, 2, 3, 4, 5]
Removed Distracting Documents: [0]
Final Improved Documents: [6, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 99
Sorted Documents: [1, 3, 5, 0, 4, 2, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 0, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 108
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 121
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3]
Final Improved Documents: [0, 2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [6, 0, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 138
Sorted Documents: [5, 1, 3, 4, 2, 0, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [1, 3, 4, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2]
Final Improved Documents: [0, 4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6]
Final Improved Documents: [0, 4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:07<00:58,  7.27s/it] 22%|██▏       | 2/9 [00:12<00:43,  6.28s/it] 33%|███▎      | 3/9 [00:16<00:30,  5.13s/it] 44%|████▍     | 4/9 [00:23<00:28,  5.72s/it] 56%|█████▌    | 5/9 [00:30<00:24,  6.13s/it] 67%|██████▋   | 6/9 [00:35<00:17,  5.76s/it] 78%|███████▊  | 7/9 [00:40<00:11,  5.79s/it] 89%|████████▉ | 8/9 [00:47<00:05,  5.98s/it]100%|██████████| 9/9 [00:51<00:00,  5.31s/it]100%|██████████| 9/9 [00:51<00:00,  5.70s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  847.4923996925354
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.58s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr0_9
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.9
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 1
Sorted Documents: [1, 3, 6, 0, 4, 2, 5]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 6, 0, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6]
Final Improved Documents: [3, 0, 5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [3, 0, 2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: []
Final Improved Documents: [0, 2, 4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 4, 1, 6]


Example 71
Sorted Documents: [6, 3, 1, 5, 0, 2, 4]
Removed Distracting Documents: []
Final Improved Documents: [6, 3, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6]
Final Improved Documents: [5, 0, 2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 92
Sorted Documents: [6, 0, 1, 2, 3, 4, 5]
Removed Distracting Documents: []
Final Improved Documents: [6, 0, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 99
Sorted Documents: [1, 3, 5, 0, 4, 2, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 0, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 108
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [4, 0, 2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 121
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [3, 0, 2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 6, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 5, 0, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 138
Sorted Documents: [1, 3, 5, 4, 2, 0, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 4, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: []
Final Improved Documents: [2, 0, 4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [4, 0, 2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 0, 4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:53,  6.63s/it] 22%|██▏       | 2/9 [00:13<00:45,  6.51s/it] 33%|███▎      | 3/9 [00:17<00:34,  5.70s/it] 44%|████▍     | 4/9 [00:23<00:28,  5.71s/it] 56%|█████▌    | 5/9 [00:30<00:25,  6.31s/it] 67%|██████▋   | 6/9 [00:37<00:19,  6.58s/it] 78%|███████▊  | 7/9 [00:43<00:12,  6.10s/it] 89%|████████▉ | 8/9 [00:50<00:06,  6.59s/it]100%|██████████| 9/9 [00:55<00:00,  6.14s/it]100%|██████████| 9/9 [00:55<00:00,  6.22s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  850.1538782119751
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/thr1_0
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 1.0
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 1
Sorted Documents: [1, 3, 6, 0, 4, 2, 5]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 6, 0, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: []
Final Improved Documents: [3, 5, 0, 4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: []
Final Improved Documents: [6, 3, 0, 5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 3, 0, 2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: []
Final Improved Documents: [0, 2, 4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [3, 5, 0, 4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 4, 1, 6]


Example 71
Sorted Documents: [6, 3, 1, 5, 0, 2, 4]
Removed Distracting Documents: []
Final Improved Documents: [6, 3, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: []
Final Improved Documents: [6, 5, 0, 2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 92
Sorted Documents: [6, 0, 1, 2, 3, 4, 5]
Removed Distracting Documents: []
Final Improved Documents: [6, 0, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 99
Sorted Documents: [1, 3, 5, 0, 4, 2, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 0, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [6, 4, 0, 2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [6, 4, 0, 2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 108
Sorted Documents: [5, 6, 4, 0, 2, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 6, 4, 0, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 4, 0, 2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 121
Sorted Documents: [5, 6, 4, 0, 2, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 6, 4, 0, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [6, 4, 0, 2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 3, 0, 2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [6, 4, 5, 0, 2, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [6, 4, 5, 0, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 138
Sorted Documents: [1, 3, 5, 4, 2, 0, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 4, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: []
Final Improved Documents: [2, 0, 4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 5, 0, 2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [3, 5, 0, 4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 4, 0, 2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 6, 0, 2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: []
Final Improved Documents: [3, 6, 0, 4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:47,  6.00s/it] 22%|██▏       | 2/9 [00:12<00:44,  6.33s/it] 33%|███▎      | 3/9 [00:18<00:37,  6.32s/it] 44%|████▍     | 4/9 [00:26<00:34,  6.86s/it] 56%|█████▌    | 5/9 [00:33<00:28,  7.05s/it] 67%|██████▋   | 6/9 [00:38<00:18,  6.18s/it] 78%|███████▊  | 7/9 [00:45<00:13,  6.57s/it] 89%|████████▉ | 8/9 [00:52<00:06,  6.46s/it]100%|██████████| 9/9 [00:54<00:00,  5.35s/it]100%|██████████| 9/9 [00:55<00:00,  6.11s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  847.6831834316254
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.37s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold0
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 0
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [3, 5, 1, 4, 0, 2, 6]
Removed Distracting Documents: [3, 5, 1]
Final Improved Documents: [4, 0, 2, 6]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 9
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 10
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [6, 3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 13
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 14
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 17
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 18
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 19
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [6, 3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 28
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 44
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 55
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 56
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 57
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 60
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 61
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 65
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [6, 5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [6, 5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 69
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 70
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 72
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [0, 6, 2, 4, 1, 3, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [4, 1, 3, 5]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 81
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 86
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 99
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 105
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 108
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 123
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 124
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 125
Sorted Documents: [6, 3, 0, 4, 2, 5, 1]
Removed Distracting Documents: [6, 3, 0, 4, 2]
Final Improved Documents: [5, 1]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 133
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 134
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [2, 0, 4, 5, 3, 1, 6]
Removed Distracting Documents: [2, 0, 4, 5]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 142
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [6, 2, 0, 4, 3, 1, 5]
Removed Distracting Documents: [6, 2, 0, 4]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 148
Sorted Documents: [6, 3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 149
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 150
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 0
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:51,  6.39s/it] 22%|██▏       | 2/9 [00:09<00:32,  4.67s/it] 33%|███▎      | 3/9 [00:13<00:24,  4.07s/it] 44%|████▍     | 4/9 [00:18<00:22,  4.56s/it] 56%|█████▌    | 5/9 [00:23<00:19,  4.84s/it] 67%|██████▋   | 6/9 [00:29<00:15,  5.14s/it] 78%|███████▊  | 7/9 [00:34<00:10,  5.20s/it] 89%|████████▉ | 8/9 [00:39<00:05,  5.05s/it]100%|██████████| 9/9 [00:43<00:00,  4.84s/it]100%|██████████| 9/9 [00:44<00:00,  4.90s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  837.375586271286
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold1
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 1
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 9
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 10
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 25
Sorted Documents: [2, 0, 5, 4, 1, 6, 3]
Removed Distracting Documents: [2, 0, 5]
Final Improved Documents: [4, 1, 6, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [2, 0, 4, 6, 5, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [6, 5, 1, 3]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 55
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 56
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 57
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 60
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 63
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 64
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 65
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 66
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 69
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 70
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 72
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 75
Sorted Documents: [3, 0, 5, 4, 1, 6, 2]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 6, 2]


Example 76
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 85
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 86
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 90
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 99
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 100
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 105
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 113
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 117
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [2, 0, 4, 5, 6, 3, 1]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [5, 6, 3, 1]


Example 122
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 123
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 126
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 127
Sorted Documents: [2, 5, 0, 4, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 4]
Final Improved Documents: [1, 6, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [6, 4, 5, 2, 3, 0, 1]
Removed Distracting Documents: [6, 4, 5, 2]
Final Improved Documents: [3, 0, 1]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 141
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 142
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [2, 5, 0, 4, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 4]
Final Improved Documents: [1, 6, 3]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [5, 0, 2, 1, 6, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 6, 4, 3]


Example 150
Sorted Documents: [5, 3, 0, 6, 1, 2, 4]
Removed Distracting Documents: [5, 3, 0, 6]
Final Improved Documents: [1, 2, 4]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 1
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:03<00:28,  3.60s/it] 22%|██▏       | 2/9 [00:09<00:33,  4.80s/it] 33%|███▎      | 3/9 [00:12<00:25,  4.30s/it] 44%|████▍     | 4/9 [00:17<00:22,  4.41s/it] 56%|█████▌    | 5/9 [00:22<00:18,  4.74s/it] 67%|██████▋   | 6/9 [00:28<00:15,  5.09s/it] 78%|███████▊  | 7/9 [00:33<00:10,  5.06s/it] 89%|████████▉ | 8/9 [00:36<00:04,  4.53s/it]100%|██████████| 9/9 [00:39<00:00,  3.77s/it]100%|██████████| 9/9 [00:39<00:00,  4.35s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  844.6330676078796
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.54s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold2
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 2
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 1
Sorted Documents: [5, 0, 3, 1, 4, 2, 6]
Removed Distracting Documents: [5, 0, 3]
Final Improved Documents: [1, 4, 2, 6]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 6
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 9
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 10
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 13
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 14
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 35
Sorted Documents: [2, 0, 5, 4, 3, 1, 6]
Removed Distracting Documents: [2, 0, 5, 4]
Final Improved Documents: [3, 1, 6]


Example 36
Sorted Documents: [2, 0, 4, 1, 5, 3, 6]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [1, 5, 3, 6]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [2, 0, 4, 5, 3, 1, 6]
Removed Distracting Documents: [2, 0, 4, 5]
Final Improved Documents: [3, 1, 6]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [2, 5, 0, 4, 6, 1, 3]
Removed Distracting Documents: [2, 5, 0, 4]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 50
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 55
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 56
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 57
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 60
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 63
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 64
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [2, 5, 0, 4, 6, 1, 3]
Removed Distracting Documents: [2, 5, 0, 4]
Final Improved Documents: [6, 1, 3]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 69
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 70
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Sorted Documents: [3, 1, 6, 5, 0, 2, 4]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [6, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 26158,
                "score": 0.2
            },
            {
                "index": 6066858,
                "score": 0.1
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 81
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 6, 0, 3, 1, 5, 2]
Removed Distracting Documents: [4, 6, 0, 3]
Final Improved Documents: [1, 5, 2]


Example 85
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 86
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 99
Sorted Documents: [6, 0, 3, 1, 4, 2, 5]
Removed Distracting Documents: [6, 0, 3]
Final Improved Documents: [1, 4, 2, 5]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [5, 2, 0, 4, 1, 6, 3]
Removed Distracting Documents: [5, 2, 0, 4]
Final Improved Documents: [1, 6, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [2, 0, 4, 5, 6, 3, 1]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [5, 6, 3, 1]


Example 122
Sorted Documents: [5, 0, 3, 1, 2, 4, 6]
Removed Distracting Documents: [5, 0, 3]
Final Improved Documents: [1, 2, 4, 6]


Example 123
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 126
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 127
Sorted Documents: [2, 0, 4, 5, 3, 1, 6]
Removed Distracting Documents: [2, 0, 4, 5]
Final Improved Documents: [3, 1, 6]


Example 128
Sorted Documents: [4, 0, 6, 1, 5, 2, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [1, 5, 2, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [2, 0, 5, 4, 1, 6, 3]
Removed Distracting Documents: [2, 0, 5]
Final Improved Documents: [4, 1, 6, 3]


Example 138
Sorted Documents: [6, 4, 5, 2, 3, 0, 1]
Removed Distracting Documents: [6, 4, 5, 2]
Final Improved Documents: [3, 0, 1]


Example 139
Sorted Documents: [6, 2, 0, 4, 5, 3, 1]
Removed Distracting Documents: [6, 2, 0, 4, 5]
Final Improved Documents: [3, 1]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 3, 0, 5, 2, 6, 1]
Removed Distracting Documents: [4, 3, 0, 5, 2]
Final Improved Documents: [6, 1]


Example 142
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 150
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:40,  5.03s/it] 22%|██▏       | 2/9 [00:10<00:35,  5.05s/it] 33%|███▎      | 3/9 [00:14<00:28,  4.79s/it] 44%|████▍     | 4/9 [00:20<00:26,  5.23s/it] 56%|█████▌    | 5/9 [00:26<00:22,  5.58s/it] 67%|██████▋   | 6/9 [00:31<00:16,  5.36s/it] 78%|███████▊  | 7/9 [00:36<00:10,  5.36s/it] 89%|████████▉ | 8/9 [00:40<00:04,  4.84s/it]100%|██████████| 9/9 [00:44<00:00,  4.60s/it]100%|██████████| 9/9 [00:44<00:00,  4.98s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  836.4489226341248
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.71s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold3
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1, 6]


Example 71
Sorted Documents: [3, 1, 6, 5, 0, 2, 4]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [6, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:04<00:38,  4.81s/it] 22%|██▏       | 2/9 [00:10<00:36,  5.14s/it] 33%|███▎      | 3/9 [00:15<00:30,  5.13s/it] 44%|████▍     | 4/9 [00:21<00:27,  5.42s/it] 56%|█████▌    | 5/9 [00:27<00:22,  5.70s/it] 67%|██████▋   | 6/9 [00:31<00:15,  5.18s/it] 78%|███████▊  | 7/9 [00:37<00:10,  5.39s/it] 89%|████████▉ | 8/9 [00:41<00:04,  4.93s/it]100%|██████████| 9/9 [00:44<00:00,  4.37s/it]100%|██████████| 9/9 [00:44<00:00,  4.95s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  846.1587245464325
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.68s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold4
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 4
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 6
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 10
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [3, 0, 6, 2, 5, 1, 4]
Removed Distracting Documents: [3, 0, 6, 2]
Final Improved Documents: [5, 1, 4]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 29
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [5, 4, 0, 2, 6, 3, 1]
Removed Distracting Documents: [5, 4, 0, 2, 6]
Final Improved Documents: [3, 1]


Example 32
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 33
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 41
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 42
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 50
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 69
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 70
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.8
            },
            {
                "index": 20971206,
                "score": 0.6
            },
            {
                "index": 1464484,
                "score": 0.4
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 74
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 85
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 86
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 2, 6, 3, 5, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 6, 3, 5, 4]


Example 93
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 105
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [6, 3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 115
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [6, 5, 0, 3, 1, 4, 2]
Removed Distracting Documents: [6, 5, 0, 3]
Final Improved Documents: [1, 4, 2]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 142
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [5, 2, 0, 4, 6, 1, 3]
Removed Distracting Documents: [5, 2, 0, 4]
Final Improved Documents: [6, 1, 3]


Example 145
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 146
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:47,  5.91s/it] 22%|██▏       | 2/9 [00:11<00:38,  5.51s/it] 33%|███▎      | 3/9 [00:16<00:31,  5.26s/it] 44%|████▍     | 4/9 [00:21<00:26,  5.28s/it] 56%|█████▌    | 5/9 [00:27<00:21,  5.41s/it] 67%|██████▋   | 6/9 [00:32<00:15,  5.28s/it] 78%|███████▊  | 7/9 [00:37<00:10,  5.46s/it] 89%|████████▉ | 8/9 [00:41<00:05,  5.01s/it]100%|██████████| 9/9 [00:45<00:00,  4.46s/it]100%|██████████| 9/9 [00:45<00:00,  5.03s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  839.9532082080841
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.64s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold5
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 5
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 6
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 13
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 14
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 18
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 19
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 28
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 33
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 41
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 42
Sorted Documents: [6, 5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [6, 5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 43
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 44
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 50
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [5, 0, 6, 2, 1, 3, 4]
Removed Distracting Documents: [5, 0, 6, 2]
Final Improved Documents: [1, 3, 4]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 5, 2, 1, 6, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [1, 6, 3]


Example 58
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 59
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 67
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 70
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 6066858,
                "score": 0.5
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 20971206,
                "score": 0.4
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 85
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 86
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 88
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 5, 6, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [5, 6, 2, 3, 4]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [2, 0, 6, 1, 5, 4, 3]
Removed Distracting Documents: [2, 0, 6]
Final Improved Documents: [1, 5, 4, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 97
Sorted Documents: [5, 4, 0, 6, 2, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6]
Final Improved Documents: [1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 103
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 104
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [5, 6, 0, 4, 1, 2, 3]
Removed Distracting Documents: [5, 6, 0, 4]
Final Improved Documents: [1, 2, 3]


Example 107
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 120
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 0, 3, 1, 4, 2, 5]
Removed Distracting Documents: [6, 0, 3]
Final Improved Documents: [1, 4, 2, 5]


Example 123
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 133
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 140
Sorted Documents: [4, 0, 2, 5, 1, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 142
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 143
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 144
Sorted Documents: [5, 2, 0, 4, 6, 1, 3]
Removed Distracting Documents: [5, 2, 0, 4]
Final Improved Documents: [6, 1, 3]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 147
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:44,  5.61s/it] 22%|██▏       | 2/9 [00:11<00:39,  5.60s/it] 33%|███▎      | 3/9 [00:16<00:32,  5.47s/it] 44%|████▍     | 4/9 [00:21<00:27,  5.40s/it] 56%|█████▌    | 5/9 [00:28<00:22,  5.70s/it] 67%|██████▋   | 6/9 [00:34<00:17,  5.82s/it] 78%|███████▊  | 7/9 [00:38<00:10,  5.19s/it] 89%|████████▉ | 8/9 [00:42<00:04,  4.90s/it]100%|██████████| 9/9 [00:45<00:00,  4.40s/it]100%|██████████| 9/9 [00:45<00:00,  5.07s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  840.5673093795776
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.58s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]
LLM loaded

ARGUMENTS:
output_dir: data/100out_improved/7doc_gold6
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 6
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 6
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 7
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 10
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 11
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 12
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 13
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 14
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 18
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 19
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 20
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 22
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 27
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 28
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 29
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 32
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 33
Sorted Documents: [5, 0, 3, 1, 2, 4, 6]
Removed Distracting Documents: [5, 0, 3]
Final Improved Documents: [1, 2, 4, 6]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 36
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 41
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 42
Sorted Documents: [5, 0, 2, 1, 6, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 6, 4, 3]


Example 43
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 46
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 51
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 55
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [6, 5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [6, 5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 62
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 63
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 64
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 67
Sorted Documents: [5, 0, 6, 1, 2, 4, 3]
Removed Distracting Documents: [5, 0, 6]
Final Improved Documents: [1, 2, 4, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 70
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 71
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 72
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 73
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 74
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 81
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [5, 0, 3, 6, 1, 4, 2]
Removed Distracting Documents: [5, 0, 3]
Final Improved Documents: [6, 1, 4, 2]


Example 85
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 86
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 88
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 91
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [0, 1, 2, 3, 4, 5, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6]


Example 93
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [6, 4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 103
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 104
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 105
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 114
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 115
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 116
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 120
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 0, 3, 1, 4, 2, 5]
Removed Distracting Documents: [6, 0, 3]
Final Improved Documents: [1, 4, 2, 5]


Example 123
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 124
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 125
Sorted Documents: [6, 0, 2, 4, 1, 3, 5]
Removed Distracting Documents: [6, 0, 2]
Final Improved Documents: [4, 1, 3, 5]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 128
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 129
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 130
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 131
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 134
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 138
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 141
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 142
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 143
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 144
Sorted Documents: [5, 2, 0, 4, 6, 3, 1]
Removed Distracting Documents: [5, 2, 0, 4, 6]
Final Improved Documents: [3, 1]


Example 145
Sorted Documents: [0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 146
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 147
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 6
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:47,  5.96s/it] 22%|██▏       | 2/9 [00:11<00:40,  5.81s/it] 33%|███▎      | 3/9 [00:16<00:32,  5.44s/it] 44%|████▍     | 4/9 [00:21<00:25,  5.04s/it] 56%|█████▌    | 5/9 [00:26<00:20,  5.20s/it] 67%|██████▋   | 6/9 [00:31<00:14,  5.00s/it] 78%|███████▊  | 7/9 [00:35<00:09,  4.93s/it] 89%|████████▉ | 8/9 [00:39<00:04,  4.62s/it]100%|██████████| 9/9 [00:42<00:00,  3.90s/it]100%|██████████| 9/9 [00:42<00:00,  4.70s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  814.3906903266907
