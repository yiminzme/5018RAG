Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.36s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.58s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 1
num_documents_in_context: 3
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 1
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 2
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 3
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 4
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 5
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 6
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 7
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 8
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 9
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 10
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 11
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 12
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 13
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 14
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 15
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 16
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 17
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 18
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 19
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 20
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 21
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 22
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 23
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 24
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 25
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 26
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 27
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 28
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 29
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 30
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 31
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 32
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 33
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 34
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 35
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 36
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 37
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 38
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 39
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 40
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 41
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 42
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 43
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 44
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 45
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 46
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 47
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 48
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 49
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 50
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 51
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 52
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 53
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 54
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 55
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 56
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 57
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 58
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 59
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 60
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 61
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 62
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 63
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 64
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 65
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 66
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 67
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 68
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 69
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 70
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 71
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 72
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 73
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 74
Sorted Documents: [1, 0, 2]
Removed Distracting Documents: [1, 0]
Final Improved Documents: [2]


Example 75
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 76
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 77
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 78
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 79
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 80
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 81
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 82
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 83
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 84
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 85
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 86
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 87
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 88
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 89
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 90
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 91
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 92
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 93
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 94
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 95
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 96
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 97
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 98
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 99
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 100
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 101
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 102
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 103
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 104
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 105
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 106
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 107
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 108
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 109
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 110
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 111
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 112
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 113
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 114
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 115
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 116
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 117
Sorted Documents: [2, 0, 1]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1]


Example 118
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 119
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 120
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 121
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 122
Sorted Documents: [1, 0, 2]
Removed Distracting Documents: [1]
Final Improved Documents: [0, 2]


Example 123
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 124
Sorted Documents: [2, 1, 0]
Removed Distracting Documents: [2]
Final Improved Documents: [1, 0]


Example 125
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 126
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: [1]
Final Improved Documents: [2, 0]


Example 127
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 128
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 129
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 130
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 131
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 132
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 133
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 134
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 135
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 136
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 137
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 138
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 139
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 140
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


Example 141
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 142
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 143
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 144
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 145
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 146
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2]


Example 147
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 148
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1]


Example 149
Sorted Documents: [1, 2, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 0]


Example 150
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 151
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 2]


Example 152
Sorted Documents: [0, 1, 2]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2]


Example 153
Sorted Documents: [0, 2, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 1
NUM DOCUMENTS IN CONTEXT: 3
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:41,  5.17s/it] 22%|██▏       | 2/9 [00:10<00:35,  5.09s/it] 33%|███▎      | 3/9 [00:15<00:30,  5.01s/it] 44%|████▍     | 4/9 [00:20<00:25,  5.03s/it] 56%|█████▌    | 5/9 [00:25<00:20,  5.01s/it] 67%|██████▋   | 6/9 [00:30<00:15,  5.04s/it] 78%|███████▊  | 7/9 [00:35<00:10,  5.13s/it] 89%|████████▉ | 8/9 [00:40<00:05,  5.13s/it]100%|██████████| 9/9 [00:44<00:00,  4.75s/it]100%|██████████| 9/9 [00:44<00:00,  4.96s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  592.3734965324402
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.59s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.73s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 2
num_documents_in_context: 4
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 1
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 3
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 4
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 6
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 3, 1]


Example 7
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 8
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 9
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 11
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 13
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 14
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 15
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 16
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 17
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 18
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 19
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 20
Sorted Documents: [3, 0, 1, 2]
Removed Distracting Documents: [3, 0]
Final Improved Documents: [1, 2]


Example 21
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 22
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 23
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 24
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 25
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 26
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 27
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 28
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 29
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 30
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 31
Sorted Documents: [2, 1, 3, 0]
Removed Distracting Documents: [2, 1]
Final Improved Documents: [3, 0]


Example 32
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 33
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 34
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 35
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 37
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 38
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 39
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 40
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 41
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 42
Sorted Documents: [1, 3, 0, 2]
Removed Distracting Documents: [1]
Final Improved Documents: [3, 0, 2]


Example 43
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 44
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 45
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 47
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 48
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 49
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 50
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 51
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 52
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 53
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 54
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 55
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 56
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 57
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 58
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 59
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 60
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 61
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 63
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 64
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 65
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 1, 3]


Example 66
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 67
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 68
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 69
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 70
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 71
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 72
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 73
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 74
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 76
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 78
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 79
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 80
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 82
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 83
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 84
Sorted Documents: [0, 3, 2, 1]
Removed Distracting Documents: [0, 3, 2]
Final Improved Documents: [1]


Example 85
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


Example 86
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 87
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 88
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 89
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 90
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 91
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 92
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3]


Example 93
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 94
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 96
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 97
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 99
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 100
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 101
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 102
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 103
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 104
Sorted Documents: [1, 2, 3, 0]
Removed Distracting Documents: []
Final Improved Documents: [1, 2, 3, 0]


Example 105
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 106
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 107
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 108
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 109
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 110
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 111
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 112
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0, 3]
Final Improved Documents: [1, 2]


Example 113
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 114
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 115
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 116
Sorted Documents: [1, 3, 2, 0]
Removed Distracting Documents: [1, 3]
Final Improved Documents: [2, 0]


Example 117
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 118
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 119
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 120
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 121
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 122
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 2]


Example 123
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 126
Sorted Documents: [2, 0, 3, 1]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [3, 1]


Example 127
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 128
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 129
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 131
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 132
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 133
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 134
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 135
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 136
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 137
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 138
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 139
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 140
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 141
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 142
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 143
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 144
Sorted Documents: [3, 0, 2, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1]


Example 145
Sorted Documents: [0, 1, 2, 3]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3]


Example 146
Sorted Documents: [0, 3, 1, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [3, 1, 2]


Example 147
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 148
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 149
Sorted Documents: [0, 2, 3, 1]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1]


Example 150
Sorted Documents: [0, 2, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [1, 3]


Example 151
Sorted Documents: [2, 0, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3]


Example 152
Sorted Documents: [2, 1, 3, 0]
Removed Distracting Documents: [2, 1]
Final Improved Documents: [3, 0]


Example 153
Sorted Documents: [0, 1, 3, 2]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [3, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 4
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:44,  5.54s/it] 22%|██▏       | 2/9 [00:10<00:37,  5.35s/it] 33%|███▎      | 3/9 [00:15<00:30,  5.01s/it] 44%|████▍     | 4/9 [00:20<00:26,  5.25s/it] 56%|█████▌    | 5/9 [00:26<00:21,  5.25s/it] 67%|██████▋   | 6/9 [00:31<00:15,  5.16s/it] 78%|███████▊  | 7/9 [00:36<00:10,  5.18s/it] 89%|████████▉ | 8/9 [00:41<00:05,  5.13s/it]100%|██████████| 9/9 [00:45<00:00,  4.83s/it]100%|██████████| 9/9 [00:45<00:00,  5.07s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  644.2824158668518
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 2
num_documents_in_context: 5
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 1
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 3
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 4
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 6
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 7
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 8
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 9
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 10
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 11
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 13
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 14
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 15
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 16
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 17
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 18
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 19
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 20
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 21
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 22
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 24
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 25
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 26
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 27
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 28
Sorted Documents: [0, 2, 4, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [3, 1]


Example 29
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 30
Sorted Documents: [4, 2, 0, 1, 3]
Removed Distracting Documents: [4, 2, 0]
Final Improved Documents: [1, 3]


Example 31
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 32
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 33
Sorted Documents: [0, 1, 3, 4, 2]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 4, 2]


Example 34
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 35
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [1, 3]


Example 37
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 38
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 39
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 40
Sorted Documents: [3, 1, 4, 0, 2]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [4, 0, 2]


Example 41
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 42
Sorted Documents: [4, 4, 2, 1, 0, 3]
Removed Distracting Documents: [4, 4, 2]
Final Improved Documents: [1, 0, 3]


Example 43
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 44
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 45
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 47
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 48
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 49
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 50
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 51
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 52
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 53
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 55
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 56
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 57
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 58
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 59
Sorted Documents: [4, 0, 3, 1, 2]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 2]


Example 60
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 61
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 62
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 63
Sorted Documents: [2, 0, 1, 3, 4]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [1, 3, 4]


Example 64
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 65
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 66
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [1, 3]


Example 67
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 68
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 69
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 70
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 71
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 73
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 74
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 75
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 76
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 78
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 79
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 80
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 82
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 83
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 84
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 85
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 86
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 87
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 88
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 89
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 90
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 91
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [2, 3, 4]


Example 93
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 94
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 96
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 97
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 98
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 99
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 100
Sorted Documents: [0, 3, 1, 2, 4]
Removed Distracting Documents: [0, 3]
Final Improved Documents: [1, 2, 4]


Example 101
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 102
Sorted Documents: [4, 0, 2, 3, 1]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [3, 1]


Example 103
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 104
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 105
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 106
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 107
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 108
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 109
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 110
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 111
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 112
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 113
Sorted Documents: [0, 2, 3, 1, 4]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [3, 1, 4]


Example 114
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 115
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 116
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 117
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 118
Sorted Documents: [0, 2, 4, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [3, 1]


Example 119
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 120
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 121
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 122
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 123
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 126
Sorted Documents: [2, 0, 4, 1, 3]
Removed Distracting Documents: [2, 0]
Final Improved Documents: [4, 1, 3]


Example 127
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 128
Sorted Documents: [3, 0, 2, 4, 1]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [4, 1]


Example 129
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 131
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 132
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 133
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 134
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 135
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 136
Sorted Documents: [0, 2, 4, 1, 3]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [4, 1, 3]


Example 137
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 138
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 139
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 140
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 141
Sorted Documents: [4, 3, 0, 2, 1]
Removed Distracting Documents: [4, 3, 0, 2]
Final Improved Documents: [1]


Example 142
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 143
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 144
Sorted Documents: [2, 0, 4, 3, 1]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [3, 1]


Example 145
Sorted Documents: [3, 0, 2, 1, 4]
Removed Distracting Documents: [3, 0, 2]
Final Improved Documents: [1, 4]


Example 146
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 147
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 148
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 149
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 150
Sorted Documents: [3, 0, 4, 1, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 2]


Example 151
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


Example 152
Sorted Documents: [0, 1, 2, 3, 4]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4]


Example 153
Sorted Documents: [4, 0, 2, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 5
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:46,  5.83s/it] 22%|██▏       | 2/9 [00:11<00:38,  5.53s/it] 33%|███▎      | 3/9 [00:16<00:32,  5.39s/it] 44%|████▍     | 4/9 [00:21<00:26,  5.39s/it] 56%|█████▌    | 5/9 [00:27<00:21,  5.40s/it] 67%|██████▋   | 6/9 [00:32<00:16,  5.42s/it] 78%|███████▊  | 7/9 [00:37<00:10,  5.19s/it] 89%|████████▉ | 8/9 [00:42<00:05,  5.20s/it]100%|██████████| 9/9 [00:47<00:00,  4.96s/it]100%|██████████| 9/9 [00:47<00:00,  5.23s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  828.9403741359711
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.70s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 6
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 1
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 3
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 6
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 7
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 8
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 10
Sorted Documents: [3, 0, 5, 2, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [1, 4]


Example 11
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 12
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 13
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 16
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [3, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 18
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 19
Sorted Documents: [3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 20
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 21
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 24
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 25
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 26
Sorted Documents: [4, 5, 0, 3, 1, 2]
Removed Distracting Documents: [4, 5, 0, 3]
Final Improved Documents: [1, 2]


Example 27
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 29
Sorted Documents: [3, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 0, 4]
Final Improved Documents: [1, 5, 2]


Example 30
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 31
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 32
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 34
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 36
Sorted Documents: [0, 2, 4, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 38
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 39
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 40
Sorted Documents: [3, 5, 1, 4, 0, 2]
Removed Distracting Documents: [3, 5, 1]
Final Improved Documents: [4, 0, 2]


Example 41
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 43
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 44
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 46
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 47
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 49
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 50
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 53
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 55
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 56
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 57
Sorted Documents: [2, 0, 4, 5, 1, 3]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 59
Sorted Documents: [3, 0, 5, 4, 1, 2]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 2]


Example 60
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 61
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 62
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 63
Sorted Documents: [5, 3, 0, 2, 1, 4]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4]


Example 64
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 69
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 70
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 71
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4, 5]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5]


Example 73
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [5, 3, 0, 2, 4, 1]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [4, 1]


Example 75
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 76
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 77
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 82
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 84
Sorted Documents: [4, 0, 3, 1, 5, 2]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 5, 2]


Example 85
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 86
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 88
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [3, 0, 5, 4, 1, 2]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 2]


Example 90
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 92
Sorted Documents: [5, 0, 1, 2, 3, 4]
Removed Distracting Documents: [5, 0, 1]
Final Improved Documents: [2, 3, 4]


Example 93
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 94
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 95
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 96
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [0, 5, 2, 4, 1, 3]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3]


Example 98
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 99
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 100
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 101
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 103
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 105
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 106
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 107
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 3]


Example 109
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 110
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 112
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 114
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 115
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 116
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 117
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 118
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 119
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 120
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 121
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 122
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 124
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 125
Sorted Documents: [3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 126
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 128
Sorted Documents: [4, 0, 3, 1, 2, 5]
Removed Distracting Documents: [4, 0, 3]
Final Improved Documents: [1, 2, 5]


Example 129
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 130
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 131
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 132
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 133
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 135
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 136
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 137
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 0, 3]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 0, 3]


Example 139
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 141
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 142
Sorted Documents: [5, 0, 2, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [1, 4, 3]


Example 143
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 145
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 147
Sorted Documents: [4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 149
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 150
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


Example 151
Sorted Documents: [4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 152
Sorted Documents: [4, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 3]


Example 153
Sorted Documents: [3, 5, 0, 4, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 6
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:05<00:42,  5.31s/it] 22%|██▏       | 2/9 [00:10<00:38,  5.48s/it] 33%|███▎      | 3/9 [00:15<00:31,  5.21s/it] 44%|████▍     | 4/9 [00:21<00:26,  5.36s/it] 56%|█████▌    | 5/9 [00:26<00:21,  5.35s/it] 67%|██████▋   | 6/9 [00:31<00:15,  5.27s/it] 78%|███████▊  | 7/9 [00:36<00:10,  5.18s/it] 89%|████████▉ | 8/9 [00:42<00:05,  5.26s/it]100%|██████████| 9/9 [00:46<00:00,  4.88s/it]100%|██████████| 9/9 [00:46<00:00,  5.15s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  853.5973613262177
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.63s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.77s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 4
num_documents_in_context: 8
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 2
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 3
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 5
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 6
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 8
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 9
Sorted Documents: [3, 5, 0, 6, 4, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [7, 1, 2]


Example 10
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 11
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 13
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 14
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 18
Sorted Documents: [6, 0, 5, 1, 4, 2, 7, 3]
Removed Distracting Documents: [6, 0, 5]
Final Improved Documents: [1, 4, 2, 7, 3]


Example 19
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 20
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 22
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 23
Sorted Documents: [3, 6, 4, 1, 7, 5, 0, 2]
Removed Distracting Documents: [3, 6, 4, 1]
Final Improved Documents: [7, 5, 0, 2]


Example 24
Sorted Documents: [4, 0, 5, 2, 7, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [7, 6, 1, 3]


Example 25
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 26
Sorted Documents: [1, 7, 6, 4, 3, 2, 5, 0]
Removed Distracting Documents: [1, 7, 6, 4, 3, 2]
Final Improved Documents: [5, 0]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 28
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 29
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 30
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 31
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 33
Sorted Documents: [7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 34
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 35
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 36
Sorted Documents: [4, 0, 6, 1, 2, 7, 3, 5]
Removed Distracting Documents: [4, 0, 6, 1]
Final Improved Documents: [2, 7, 3, 5]


Example 37
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 40
Sorted Documents: [3, 5, 0, 6, 4, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [7, 1, 2]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 7, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 45
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 46
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 47
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 49
Sorted Documents: [4, 7, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 7, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [6, 4, 0, 2, 7, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 51
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [4, 0, 5, 2, 6, 1, 7, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 53
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [7, 3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [7, 3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 55
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 56
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 57
Sorted Documents: [6, 2, 0, 4, 5, 3, 1, 7]
Removed Distracting Documents: [6, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 7]


Example 58
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 61
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 63
Sorted Documents: [3, 0, 5, 4, 1, 6, 2, 7]
Removed Distracting Documents: [3, 0, 5, 4]
Final Improved Documents: [1, 6, 2, 7]


Example 64
Sorted Documents: [4, 0, 6, 2, 5, 1, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3, 7]


Example 65
Sorted Documents: [7, 3, 1, 5, 4, 0, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5]
Final Improved Documents: [4, 0, 2, 6]


Example 66
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 67
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 69
Sorted Documents: [5, 0, 6, 7, 2, 3, 1, 4]
Removed Distracting Documents: [5, 0, 6, 7, 2]
Final Improved Documents: [3, 1, 4]


Example 70
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 71
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.2
            },
            {
                "index": 4,
                "score": 0.8
            },
            {
                "index": 5,
                "score": 0.1
            },
            {
                "index": 6,
                "score": 0.4
            },
            {
                "index": 7,
                "score": 0.6
            },
            {
                "index": 8,
                "score
Example 72
Sorted Documents: [5, 0, 7, 2, 4, 6, 1, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [4, 6, 1, 3]


Example 73
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 74
Sorted Documents: [4, 2, 7, 0, 5, 3, 1, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [2, 7, 0, 5, 3, 1, 6]


Example 75
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 76
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 78
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 79
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 80
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 81
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 83
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 85
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 87
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 89
Sorted Documents: [7, 5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [7, 5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 92
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 93
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 2]


Example 94
Sorted Documents: [7, 2, 1, 6, 4, 5, 3, 0]
Removed Distracting Documents: [7, 2, 1, 6]
Final Improved Documents: [4, 5, 3, 0]


Example 95
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 97
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 100
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 101
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 104
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 105
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 107
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 108
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 109
Sorted Documents: [6, 3, 0, 5, 2, 4, 1, 7]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1, 7]


Example 110
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 111
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 112
Sorted Documents: [4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 113
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 114
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.1
            },
            {
                "index": 4,
                "score": 0.9
            },
            {
                "index": 5,
                "score": 0.2
            },
            {
                "index": 6,
                "score": 0.8
            },
            {
                "index": 7,
                "score": 0.3
            },
            {
                "index": 8,
                "score
Example 115
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 116
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 117
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 121
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 122
Sorted Documents: [0, 2, 6, 7, 4, 1, 3, 5]
Removed Distracting Documents: [0, 2]
Final Improved Documents: [6, 7, 4, 1, 3, 5]


Example 123
Sorted Documents: [4, 0, 7, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [7, 0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [6, 4, 0, 2, 7, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 129
Warning: No valid JSON found in LLM response.
[
            {
                "index": 0,
                "score": 0.7
            },
            {
                "index": 1,
                "score": 0.3
            },
            {
                "index": 2,
                "score": 0.5
            },
            {
                "index": 3,
                "score": 0.1
            },
            {
                "index": 4,
                "score": 0.9
            },
            {
                "index": 5,
                "score": 0.6
            },
            {
                "index": 6,
                "score": 0.4
            },
            {
                "index": 7,
                "score": 0.8
            },
            {
                "index": 8,
                "score
Example 130
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                Document 1:
                "score": 0.3
            },
            {
                "index": 3,
                Document 2:
                "score": 0.5
            },
            {
                "index": 4,
                Document 3:
                "score": 0.2
            },
            {
                "index": 5,
                Document 4:
                "score": 0.4
            },
            {
                "index": 6,
                Document 5:
                "score": 0.1
            },
            {
                "index": 7,
                Document 6:
                "score": 0.3
            },
Example 131
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 134
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 136
Sorted Documents: [4, 0, 7, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 138
Sorted Documents: [3, 7, 4, 5, 6, 2, 0, 1]
Removed Distracting Documents: [3, 7, 4, 5, 6]
Final Improved Documents: [2, 0, 1]


Example 139
Sorted Documents: [3, 6, 4, 1, 7, 5, 0, 2]
Removed Distracting Documents: [3, 6, 4, 1]
Final Improved Documents: [7, 5, 0, 2]


Example 140
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                "score": 0.3
            },
            {
                "index": 3,
                "score": 0.5
            },
            {
                "index": 4,
                "score": 0.1
            },
            {
                "index": 5,
                "score": 0.9
            },
            {
                "index": 6,
                "score": 0.2
            },
            {
                "index": 7,
                "score": 0.8
            },
            {
                "index": 8,
                "score": 0.4
            },
            {
                "index": 9,
                "score
Example 141
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 142
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 144
Sorted Documents: [6, 2, 0, 4, 3, 1, 7, 5]
Removed Distracting Documents: [6, 2, 0, 4]
Final Improved Documents: [3, 1, 7, 5]


Example 145
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 146
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


Example 147
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 148
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 149
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 150
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 151
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 2, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 7, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 8
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:48,  6.11s/it] 22%|██▏       | 2/9 [00:12<00:42,  6.12s/it] 33%|███▎      | 3/9 [00:17<00:34,  5.83s/it] 44%|████▍     | 4/9 [00:25<00:32,  6.44s/it] 56%|█████▌    | 5/9 [00:32<00:26,  6.66s/it] 67%|██████▋   | 6/9 [00:37<00:18,  6.24s/it] 78%|███████▊  | 7/9 [00:44<00:12,  6.50s/it] 89%|████████▉ | 8/9 [00:52<00:06,  6.94s/it]100%|██████████| 9/9 [00:56<00:00,  6.14s/it]100%|██████████| 9/9 [00:56<00:00,  6.32s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  861.0157778263092
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.55s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 4
num_documents_in_context: 9
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 1
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 5, 3]


Example 3
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 4
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 5
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 6
Sorted Documents: [7, 3, 1, 5, 6, 8, 4, 0, 2]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3]


Example 8
Sorted Documents: [7, 4, 0, 5, 2, 8, 6, 1, 3]
Removed Distracting Documents: [7, 4, 0, 5, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 9
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 10
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 11
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 12
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 13
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 14
Sorted Documents: [6, 3, 0, 7, 5, 2, 8, 4, 1]
Removed Distracting Documents: [6, 3, 0, 7, 5, 2]
Final Improved Documents: [8, 4, 1]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 17
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 18
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 19
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 20
Sorted Documents: [3, 7, 0, 5, 4, 8, 1, 6, 2]
Removed Distracting Documents: [3, 7, 0, 5, 4]
Final Improved Documents: [8, 1, 6, 2]


Example 21
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 22
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 23
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 24
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 25
Warning: No valid JSON found in LLM response.
[
            { "index": 1, "score": 0.7 }, // Document 1: Very unlikely to contain the correct answer
            { "index": 2, "score": 0.3 }, // Document 2: Unlikely to contain the correct answer
            { "index": 3, "score": 0.5 }, // Document 3: Somewhat likely to contain the correct answer
            { "index": 4, "score": 0.1 }, // Document 4: Very unlikely to contain the correct answer
            { "index": 5, "score": 0.8 }, // Document 5: Somewhat likely to contain the correct answer
            { "index": 6, "score": 0.2 }, // Document 6: Unlikely to contain the correct answer
            { "index": 7, "score": 0.4 }, // Document 7: Somewhat likely to contain the correct answer
            { "index": 8, "score": 0.6 }, // Document 8: Very unlikely to contain the correct answer
            { "index": 9, "score": 0.3 } // Document 9: Unlikely to contain the correct answer
Example 26
Sorted Documents: [4, 8, 5, 0, 6, 2, 7, 1, 3]
Removed Distracting Documents: [4, 8, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 28
Sorted Documents: [7, 4, 0, 6, 2, 5, 1, 8, 3]
Removed Distracting Documents: [7, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 3]


Example 29
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 30
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 31
Sorted Documents: [7, 1, 5, 6, 8, 4, 0, 2, 3]
Removed Distracting Documents: [7, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2, 3]


Example 32
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 33
Sorted Documents: [8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 34
Sorted Documents: [5, 0, 7, 2, 8, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 4, 3]


Example 35
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 36
Sorted Documents: [4, 0, 3, 7, 8, 1, 5, 2, 6]
Removed Distracting Documents: [4, 0, 3, 7]
Final Improved Documents: [8, 1, 5, 2, 6]


Example 37
Sorted Documents: [1, 4, 6, 3, 8, 5, 0, 7, 2]
Removed Distracting Documents: [1, 4, 6, 3]
Final Improved Documents: [8, 5, 0, 7, 2]


Example 38
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 39
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 40
Sorted Documents: [6, 5, 1, 3, 2, 0, 7, 4, 8]
Removed Distracting Documents: [6, 5, 1, 3]
Final Improved Documents: [2, 0, 7, 4, 8]


Example 41
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 44
Sorted Documents: [4, 7, 0, 2, 8, 1, 5, 3, 6]
Removed Distracting Documents: [4, 7, 0, 2, 8]
Final Improved Documents: [1, 5, 3, 6]


Example 45
Sorted Documents: [4, 0, 6, 2, 8, 7, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3, 5]


Example 46
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 5, 3]


Example 47
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 48
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 49
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 50
Sorted Documents: [4, 0, 6, 2, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 52
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 53
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 8, 2, 0, 6]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 6]


Example 55
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 56
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 5, 3]


Example 57
Sorted Documents: [6, 2, 0, 4, 5, 3, 1, 8, 7]
Removed Distracting Documents: [6, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 8, 7]


Example 58
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 59
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 61
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 63
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 64
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 3, 7]


Example 65
Sorted Documents: [7, 1, 3, 4, 8, 2, 0, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 5, 6]


Example 66
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 67
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 68
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 69
Error in processing LLM response: Expecting value: line 2 column 43 (char 44). Returning all documents by default.
Example 70
Sorted Documents: [0, 6, 2, 4, 8, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [4, 8, 1, 7, 3, 5]


Example 71
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 72
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8]


Example 73
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [7, 5, 1, 3, 4, 8, 2, 0, 6]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [8, 2, 0, 6]


Example 75
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 76
Sorted Documents: [2, 5, 0, 7, 4, 8, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 7, 4]
Final Improved Documents: [8, 1, 6, 3]


Example 77
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 78
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 79
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 81
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 82
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 83
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 84
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 85
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 86
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 87
Sorted Documents: [7, 0, 5, 2, 8, 4, 1, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [8, 4, 1, 3, 6]


Example 88
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 89
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 91
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 92
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 93
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 94
Sorted Documents: [8, 6, 7, 4, 1, 5, 2, 3, 0]
Removed Distracting Documents: [8, 6, 7, 4]
Final Improved Documents: [1, 5, 2, 3, 0]


Example 95
Sorted Documents: [7, 3, 1, 5, 6, 8, 4, 0, 2]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [8, 4, 0, 2]


Example 96
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 97
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 98
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 99
Sorted Documents: [0, 6, 1, 3, 4, 5, 7, 2, 8]
Removed Distracting Documents: [0, 6]
Final Improved Documents: [1, 3, 4, 5, 7, 2, 8]


Example 100
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 101
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 5, 3]


Example 102
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 103
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 104
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 105
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 106
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 107
Sorted Documents: [8, 4, 0, 5, 2, 6, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 5, 2]
Final Improved Documents: [6, 1, 7, 3]


Example 108
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 109
Sorted Documents: [6, 3, 0, 8, 5, 2, 4, 1, 7]
Removed Distracting Documents: [6, 3, 0, 8, 5, 2]
Final Improved Documents: [4, 1, 7]


Example 110
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3, 5]


Example 111
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 7, 3]


Example 112
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 7, 2, 8, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 5, 3]


Example 114
Sorted Documents: [3, 5, 1, 8, 7, 0, 6, 4, 2]
Removed Distracting Documents: [3, 5, 1]
Final Improved Documents: [8, 7, 0, 6, 4, 2]


Example 115
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [8, 7, 1, 3]


Example 116
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 117
Sorted Documents: [4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 118
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 120
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 121
Sorted Documents: [4, 1, 2, 5, 6, 7, 8, 0, 3]
Removed Distracting Documents: [4, 1, 2]
Final Improved Documents: [5, 6, 7, 8, 0, 3]


Example 122
Sorted Documents: [0, 6, 2, 8, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [8, 4, 1, 7, 3, 5]


Example 123
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 125
Sorted Documents: [7, 1, 6, 3, 8, 4, 0, 2, 5]
Removed Distracting Documents: [7, 1, 6, 3]
Final Improved Documents: [8, 4, 0, 2, 5]


Example 126
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 128
Sorted Documents: [7, 0, 5, 1, 3, 4, 2, 6, 8]
Removed Distracting Documents: [7, 0, 5]
Final Improved Documents: [1, 3, 4, 2, 6, 8]


Example 129
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 130
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 7, 2, 8, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [8, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 6, 2, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 134
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5]
Final Improved Documents: [8, 4, 0, 2, 6]


Example 135
Sorted Documents: [4, 0, 6, 2, 8, 5, 1, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [8, 5, 1, 7, 3]


Example 136
Sorted Documents: [4, 6, 0, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 138
Sorted Documents: [7, 4, 0, 5, 2, 6, 1, 8, 3]
Removed Distracting Documents: [7, 4, 0, 5, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 139
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 2, 8]


Example 140
Sorted Documents: [7, 1, 3, 4, 2, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 5, 6]


Example 141
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 142
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 143
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 144
Sorted Documents: [7, 2, 0, 4, 6, 8, 3, 1, 5]
Removed Distracting Documents: [7, 2, 0, 4, 6]
Final Improved Documents: [8, 3, 1, 5]


Example 145
Sorted Documents: [5, 0, 7, 2, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 146
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 148
Sorted Documents: [4, 6, 0, 2, 8, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [8, 7, 1, 5, 3]


Example 149
Sorted Documents: [3, 5, 0, 6, 4, 8, 7, 1, 2]
Removed Distracting Documents: [3, 5, 0, 6, 4]
Final Improved Documents: [8, 7, 1, 2]


Example 150
Sorted Documents: [5, 4, 1, 7, 3, 6, 8, 2, 0]
Removed Distracting Documents: [5, 4, 1, 7, 3, 6]
Final Improved Documents: [8, 2, 0]


Example 151
Sorted Documents: [5, 4, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 152
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


Example 153
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:49,  6.25s/it] 22%|██▏       | 2/9 [00:13<00:49,  7.12s/it] 33%|███▎      | 3/9 [00:19<00:39,  6.56s/it] 44%|████▍     | 4/9 [00:27<00:34,  6.91s/it] 56%|█████▌    | 5/9 [00:34<00:27,  7.00s/it] 67%|██████▋   | 6/9 [00:41<00:20,  6.88s/it] 78%|███████▊  | 7/9 [00:47<00:13,  6.71s/it] 89%|████████▉ | 8/9 [00:53<00:06,  6.49s/it]100%|██████████| 9/9 [00:58<00:00,  5.95s/it]100%|██████████| 9/9 [00:58<00:00,  6.48s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1120.5072469711304
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.71s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 5
num_documents_in_context: 10
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 7, 2, 5, 8, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [1, 6, 3, 9]


Example 1
Sorted Documents: [4, 6, 0, 2, 9, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 7, 2, 8, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 9, 5, 3]


Example 3
Sorted Documents: [5, 4, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [5, 4, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 4
Sorted Documents: [4, 5, 0, 7, 2, 9, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3]


Example 5
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 6
Sorted Documents: [4, 1, 6, 2, 8, 9, 5, 0, 3, 7]
Removed Distracting Documents: [4, 1, 6, 2]
Final Improved Documents: [8, 9, 5, 0, 3, 7]


Example 7
Sorted Documents: [3, 8, 0, 5, 4, 9, 1, 6, 2, 7]
Removed Distracting Documents: [3, 8, 0, 5, 4, 9]
Final Improved Documents: [1, 6, 2, 7]


Example 8
Sorted Documents: [3, 1, 5, 6, 9, 4, 0, 7, 2, 8]
Removed Distracting Documents: [3, 1, 5, 6]
Final Improved Documents: [9, 4, 0, 7, 2, 8]


Example 9
Sorted Documents: [8, 4, 1, 6, 3, 7, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [7, 0, 9, 2, 5]


Example 10
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 11
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 12
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 13
Sorted Documents: [9, 4, 0, 7, 2, 6, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 14
Sorted Documents: [7, 0, 5, 2, 4, 9, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 9, 1, 8, 3, 6]


Example 15
Sorted Documents: [4, 5, 0, 8, 6, 2, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 9, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 17
Sorted Documents: [4, 6, 0, 8, 2, 9, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [9, 1, 7, 5, 3]


Example 18
Sorted Documents: [9, 2, 7, 8, 1, 3, 4, 5, 6, 0]
Removed Distracting Documents: [9, 2, 7, 8]
Final Improved Documents: [1, 3, 4, 5, 6, 0]


Example 19
Sorted Documents: [4, 6, 0, 2, 9, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 20
Sorted Documents: [4, 1, 7, 3, 9, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 7, 3, 9]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 21
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 23
Warning: No valid JSON found in LLM response.
[
            {
                "index": 783397,
                "score": 0.3
            },
            {
                "index": 5175835,
                "score": 0.7
            },
            {
                "index": 7148702,
                "score": 0.2
            },
            {
                "index": 9241858,
                "score": 0.5
            },
            {
                "index": 6656900,
                "score": 0.1
            },
            {
                "index": 20970909,
                "score": 0.8
            },
            {
                "index": 6656897,
                "score": 0.4
            },
            {
                "index": 10577120,
                "score": 0.6
            },
            {
                "index": 12581050,
                "score": 0.9
            },
            {
                "index": 5175841,
                "score": 0.5
Example 24
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 25
Error in processing LLM response: Expecting value: line 2 column 43 (char 44). Returning all documents by default.
Example 26
Sorted Documents: [4, 5, 0, 6, 2, 8, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 8]
Final Improved Documents: [7, 1, 9, 3]


Example 27
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 28
Warning: No valid JSON found in LLM response.
[
            { "index": 1, "score": 0.7 }, // Document 1: unlikely to contain the correct answer
            { "index": 2, "score": 0.3 }, // Document 2: unlikely to contain the correct answer
            { "index": 3, "score": 0.5 }, // Document 3: somewhat likely to contain the correct answer
            { "index": 4, "score": 0.1 }, // Document 4: very unlikely to contain the correct answer
            { "index": 5, "score": 0.8 }, // Document 5: somewhat likely to contain the correct answer
            { "index": 6, "score": 0.2 }, // Document 6: very unlikely to contain the correct answer
            { "index": 7, "score": 0.4 }, // Document 7: somewhat likely to contain the correct answer
            { "index": 8, "score": 0.6 }, // Document 8: very likely to contain the correct answer
            { "index": 9, "score": 0.9 }, // Document 9: very likely to contain the correct answer
            { "index": 10, "score": 0.1 } // Document 10: very unlikely to contain the correct
Example 29
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 30
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 31
Sorted Documents: [9, 8, 1, 7, 6, 5, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [4, 0, 2, 3]


Example 32
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 33
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 34
Sorted Documents: [9, 4, 1, 7, 3, 6, 0, 8, 2, 5]
Removed Distracting Documents: [9, 4, 1, 7, 3]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 35
Sorted Documents: [9, 8, 2, 7, 5, 1, 3, 4, 6, 0]
Removed Distracting Documents: [9, 8, 2, 7, 5]
Final Improved Documents: [1, 3, 4, 6, 0]


Example 36
Warning: No valid JSON found in LLM response.
[
            {
                "index": 1,
                "score": 0.7
            },
            {
                "index": 2,
                document: {
                    "title": "Area codes 587 and 825",
                    "content": "Area codes 587 and 825 are telephone area codes that cover all of Alberta, Canada, in addition to the incumbent codes, southern Alberta's 403 and northern Alberta's 780."
                },
                "score": 0.8
            },
            {
                "index": 3,
                document: {
                    "title": "ZIP Codes",
                    "content": "Which are Washington, D.C. ZIP Codes, even if they are not located in Washington itself."
                },
                "score": 0.6
            },
            {
                "index": 4,
                document: {
                    "title": "Area code 785",
                    "content": "this point, area code 785 reaches its easternmost boundary with the current boundary for area code 913,"
                },
                "score": 0.5
            },
            {
Example 37
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 38
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 39
Sorted Documents: [9, 8, 1, 7, 6, 5, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [4, 0, 2, 3]


Example 40
Sorted Documents: [1, 3, 8, 5, 6, 4, 9, 0, 7, 2]
Removed Distracting Documents: [1, 3, 8, 5, 6]
Final Improved Documents: [4, 9, 0, 7, 2]


Example 41
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 42
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 44
Sorted Documents: [4, 0, 8, 2, 9, 6, 1, 7, 5, 3]
Removed Distracting Documents: [4, 0, 8, 2, 9]
Final Improved Documents: [6, 1, 7, 5, 3]


Example 45
Sorted Documents: [7, 6, 0, 5, 2, 8, 9, 4, 1, 3]
Removed Distracting Documents: [7, 6, 0, 5, 2]
Final Improved Documents: [8, 9, 4, 1, 3]


Example 46
Sorted Documents: [9, 8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [9, 8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 47
Sorted Documents: [3, 7, 0, 5, 9, 4, 8, 1, 6, 2]
Removed Distracting Documents: [3, 7, 0, 5, 9, 4, 8]
Final Improved Documents: [1, 6, 2]


Example 48
Sorted Documents: [2, 9, 5, 0, 7, 4, 6, 1, 8, 3]
Removed Distracting Documents: [2, 9, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 3]


Example 49
Warning: No valid JSON found in LLM response.
[
            {
                "index": 425425,
                "score": 0.7
            },
            {
                "index": 425421,
                "score": 0.6
            },
            {
                "index": 425497,
                "score": 0.4
            },
            {
                "index": 1107258,
                "score": 0.3
            },
            {
                "index": 3473114,
                "score": 0.2
            },
            {
                "index": 20971068,
                "score": 0.1
            },
            {
                "index": 12308970,
                "score": 0.5
            },
            {
                "index": 13204350,
                "score": 0.8
            },
            {
                "index": 425429,
                "score": 0.9
            },
            {
                "index": 2747589,
                "score": 0.6
            }
Example 50
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 53
Sorted Documents: [4, 0, 8, 2, 5, 9, 1, 7, 3, 6]
Removed Distracting Documents: [4, 0, 8, 2, 5, 9]
Final Improved Documents: [1, 7, 3, 6]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 6, 9]


Example 55
Sorted Documents: [5, 6, 0, 7, 2, 8, 1, 9, 3, 4]
Removed Distracting Documents: [5, 6, 0, 7, 2]
Final Improved Documents: [8, 1, 9, 3, 4]


Example 56
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 57
Sorted Documents: [2, 6, 4, 8, 3, 7, 0, 9, 5, 1]
Removed Distracting Documents: [2, 6, 4, 8, 3]
Final Improved Documents: [7, 0, 9, 5, 1]


Example 58
Sorted Documents: [3, 9, 5, 0, 7, 4, 6, 1, 8, 2]
Removed Distracting Documents: [3, 9, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 8, 2]


Example 59
Sorted Documents: [4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 60
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 61
Sorted Documents: [4, 9, 5, 0, 6, 2, 7, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3]


Example 62
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3]


Example 63
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 64
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 3, 7]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 3, 7]


Example 65
Sorted Documents: [7, 2, 0, 4, 5, 3, 1, 9, 6, 8]
Removed Distracting Documents: [7, 2, 0, 4, 5]
Final Improved Documents: [3, 1, 9, 6, 8]


Example 66
Sorted Documents: [2, 6, 4, 0, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [2, 6, 4, 0, 5, 9]
Final Improved Documents: [1, 8, 7, 3]


Example 67
Sorted Documents: [4, 1, 9, 7, 3, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 68
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 69
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 70
Sorted Documents: [9, 4, 1, 6, 3, 5, 0, 7, 2, 8]
Removed Distracting Documents: [9, 4, 1, 6, 3]
Final Improved Documents: [5, 0, 7, 2, 8]


Example 71
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 72
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 9, 3]


Example 73
Sorted Documents: [4, 6, 0, 9, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [7, 5, 1, 3, 4, 9, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [9, 2, 0, 6, 8]


Example 75
Sorted Documents: [4, 5, 0, 7, 2, 9, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3]


Example 76
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 9, 1, 8, 7, 3]


Example 78
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 79
Sorted Documents: [4, 0, 6, 2, 9, 7, 1, 8, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 5, 3]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 81
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 82
Sorted Documents: [9, 5, 0, 7, 2, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 83
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 84
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]


Example 85
Sorted Documents: [4, 0, 6, 2, 5, 9, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 9, 1, 8, 7, 3]


Example 86
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 87
Sorted Documents: [8, 7, 0, 5, 2, 4, 1, 9, 3, 6]
Removed Distracting Documents: [8, 7, 0, 5, 2]
Final Improved Documents: [4, 1, 9, 3, 6]


Example 88
Sorted Documents: [8, 4, 1, 7, 3, 6, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [6, 0, 9, 2, 5]


Example 89
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.8
         },
         {
            "index": 4,
            "score": 0.4
         },
         {
            "index": 5,
            "score": 0.6
         },
         {
            "index": 6,
            "score": 0.5
         },
         {
            "index": 7,
            "score": 0.4
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.1
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating the likelihood that the document is a distracting document for the given query. A score of 0 indicates a very high likelihood that the document is a distracting document,
Example 90
Sorted Documents: [4, 6, 0, 9, 2, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 91
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 92
Sorted Documents: [7, 2, 9, 5, 1, 4, 8, 0, 3, 6]
Removed Distracting Documents: [7, 2, 9, 5]
Final Improved Documents: [1, 4, 8, 0, 3, 6]


Example 93
Sorted Documents: [7, 9, 3, 1, 5, 6, 4, 0, 2, 8]
Removed Distracting Documents: [7, 9, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 2, 8]


Example 94
Sorted Documents: [8, 9, 6, 5, 4, 7, 3, 2, 1, 0]
Removed Distracting Documents: [8, 9, 6, 5, 4]
Final Improved Documents: [7, 3, 2, 1, 0]


Example 95
Sorted Documents: [7, 3, 1, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 96
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 98
Sorted Documents: [4, 9, 0, 6, 2, 7, 1, 5, 3, 8]
Removed Distracting Documents: [4, 9, 0, 6, 2, 7]
Final Improved Documents: [1, 5, 3, 8]


Example 99
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 100
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 101
Sorted Documents: [0, 9, 6, 2, 8, 5, 1, 7, 4, 3]
Removed Distracting Documents: [0, 9, 6, 2, 8]
Final Improved Documents: [5, 1, 7, 4, 3]


Example 102
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 103
Sorted Documents: [0, 4, 8, 2, 6, 1, 5, 9, 3, 7]
Removed Distracting Documents: [0, 4, 8, 2, 6]
Final Improved Documents: [1, 5, 9, 3, 7]


Example 104
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 105
Sorted Documents: [7, 0, 5, 2, 4, 9, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2]
Final Improved Documents: [4, 9, 1, 8, 3, 6]


Example 106
Sorted Documents: [4, 0, 5, 2, 6, 1, 8, 7, 3, 9]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 8, 7, 3, 9]


Example 107
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 108
Sorted Documents: [4, 0, 7, 2, 5, 8, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [1, 6, 3, 9]


Example 109
Sorted Documents: [7, 8, 0, 3, 1, 4, 5, 9, 2, 6]
Removed Distracting Documents: [7, 8, 0, 3]
Final Improved Documents: [1, 4, 5, 9, 2, 6]


Example 110
Sorted Documents: [2, 5, 0, 8, 4, 9, 7, 1, 6, 3]
Removed Distracting Documents: [2, 5, 0, 8, 4]
Final Improved Documents: [9, 7, 1, 6, 3]


Example 111
Sorted Documents: [2, 8, 5, 0, 7, 4, 6, 1, 9, 3]
Removed Distracting Documents: [2, 8, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 3]


Example 112
Sorted Documents: [6, 0, 8, 5, 2, 4, 1, 9, 7, 3]
Removed Distracting Documents: [6, 0, 8, 5, 2]
Final Improved Documents: [4, 1, 9, 7, 3]


Example 113
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 9, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 8]
Final Improved Documents: [4, 0, 9, 2, 6]


Example 114
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 115
Sorted Documents: [3, 6, 0, 8, 4, 7, 1, 9, 5, 2]
Removed Distracting Documents: [3, 6, 0, 8, 4]
Final Improved Documents: [7, 1, 9, 5, 2]


Example 116
Sorted Documents: [4, 1, 7, 3, 9, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 7, 3, 9]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 117
Sorted Documents: [0, 9, 6, 2, 8, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 9, 6, 2, 8]
Final Improved Documents: [4, 1, 7, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 119
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 120
Sorted Documents: [4, 9, 5, 0, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 121
Sorted Documents: [7, 4, 1, 6, 3, 5, 0, 9, 2, 8]
Removed Distracting Documents: [7, 4, 1, 6, 3]
Final Improved Documents: [5, 0, 9, 2, 8]


Example 122
Sorted Documents: [1, 3, 5, 7, 2, 6, 8, 9, 0, 4]
Removed Distracting Documents: [1, 3, 5, 7, 2, 6]
Final Improved Documents: [8, 9, 0, 4]


Example 123
Sorted Documents: [9, 4, 0, 6, 2, 7, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 6, 2]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 125
Sorted Documents: [8, 4, 1, 7, 3, 5, 0, 9, 2, 6]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [5, 0, 9, 2, 6]


Example 126
Sorted Documents: [9, 4, 0, 8, 6, 2, 7, 1, 3, 5]
Removed Distracting Documents: [9, 4, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 3, 5]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 128
Sorted Documents: [4, 5, 0, 6, 2, 9, 7, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3]


Example 129
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 130
Sorted Documents: [0, 8, 6, 2, 9, 4, 1, 7, 3, 5]
Removed Distracting Documents: [0, 8, 6, 2, 9]
Final Improved Documents: [4, 1, 7, 3, 5]


Example 131
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 132
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 133
Sorted Documents: [0, 6, 2, 4, 8, 1, 7, 3, 5, 9]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [4, 8, 1, 7, 3, 5, 9]


Example 134
Sorted Documents: [7, 3, 1, 5, 8, 4, 0, 9, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 8]
Final Improved Documents: [4, 0, 9, 2, 6]


Example 135
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 136
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 137
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 138
Sorted Documents: [3, 5, 0, 7, 4, 6, 1, 9, 8, 2]
Removed Distracting Documents: [3, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 8, 2]


Example 139
Sorted Documents: [4, 1, 6, 3, 9, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 6, 3, 9]
Final Improved Documents: [7, 0, 8, 2, 5]


Example 140
Sorted Documents: [7, 5, 1, 3, 4, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 0, 8, 6, 9]


Example 141
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 142
Sorted Documents: [8, 4, 1, 6, 3, 7, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [7, 0, 9, 2, 5]


Example 143
Sorted Documents: [7, 3, 1, 5, 9, 4, 0, 8, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 9]
Final Improved Documents: [4, 0, 8, 2, 6]


Example 144
Sorted Documents: [6, 2, 0, 4, 8, 3, 1, 7, 9, 5]
Removed Distracting Documents: [6, 2, 0, 4, 8]
Final Improved Documents: [3, 1, 7, 9, 5]


Example 145
Sorted Documents: [4, 0, 6, 2, 8, 1, 5, 9, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2, 8]
Final Improved Documents: [1, 5, 9, 3, 7]


Example 146
Sorted Documents: [4, 5, 0, 7, 2, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 147
Sorted Documents: [8, 4, 0, 6, 2, 5, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [5, 1, 9, 7, 3]


Example 148
Sorted Documents: [8, 3, 1, 5, 6, 4, 0, 9, 2, 7]
Removed Distracting Documents: [8, 3, 1, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 7]


Example 149
Sorted Documents: [9, 8, 7, 0, 6, 2, 5, 1, 4, 3]
Removed Distracting Documents: [9, 8, 7, 0, 6, 2]
Final Improved Documents: [5, 1, 4, 3]


Example 150
Sorted Documents: [8, 4, 1, 6, 3, 9, 5, 0, 2, 7]
Removed Distracting Documents: [8, 4, 1, 6, 3]
Final Improved Documents: [9, 5, 0, 2, 7]


Example 151
Sorted Documents: [4, 5, 0, 8, 6, 2, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [7, 1, 9, 3]


Example 152
Sorted Documents: [5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 153
Sorted Documents: [4, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 10
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:06<00:55,  6.88s/it] 22%|██▏       | 2/9 [00:15<00:53,  7.65s/it] 33%|███▎      | 3/9 [00:23<00:48,  8.00s/it] 44%|████▍     | 4/9 [00:29<00:35,  7.19s/it] 56%|█████▌    | 5/9 [00:38<00:30,  7.74s/it] 67%|██████▋   | 6/9 [00:44<00:21,  7.24s/it] 78%|███████▊  | 7/9 [00:50<00:13,  6.96s/it] 89%|████████▉ | 8/9 [00:57<00:06,  6.88s/it]100%|██████████| 9/9 [01:02<00:00,  6.19s/it]100%|██████████| 9/9 [01:02<00:00,  6.91s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1217.478845834732
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.72s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_cot_100out
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 5
num_documents_in_context: 11
get_documents_without_answer: True
max_new_tokens: 100
batch_size: 18
save_every: 2
cot: True
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.9
         },
         {
            "index": 6,
            "score": 0.5
         },
         {
            "index": 7,
            "score": 0.7
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 9,
            "score": 0.5
         },
         {
            "index": 10,
            "score": 0.1
         },
         {
            "index": 11,
            "score": 0.9
         }

Explanation:
The given documents are highly relevant to the query but are unlikely to contain the correct answer. Document 1 has a low score because it does not provide any information related to the query. Document 2 has a moderate score because it provides some information related to the query,
Example 1
Sorted Documents: [4, 9, 0, 7, 2, 10, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 9, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 5, 3]


Example 2
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 3
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 4
Sorted Documents: [9, 8, 1, 7, 6, 5, 10, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [10, 4, 0, 2, 3]


Example 5
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 6
Sorted Documents: [4, 1, 6, 2, 8, 9, 10, 5, 0, 3, 7]
Removed Distracting Documents: [4, 1, 6, 2]
Final Improved Documents: [8, 9, 10, 5, 0, 3, 7]


Example 7
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 8
Sorted Documents: [9, 8, 1, 7, 6, 5, 10, 4, 0, 2, 3]
Removed Distracting Documents: [9, 8, 1, 7, 6, 5]
Final Improved Documents: [10, 4, 0, 2, 3]


Example 9
Sorted Documents: [3, 10, 5, 0, 7, 4, 6, 1, 9, 8, 2]
Removed Distracting Documents: [3, 10, 5, 0, 7, 4]
Final Improved Documents: [6, 1, 9, 8, 2]


Example 10
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.2
         },
         {
            "index": 5,
            "score": 0.4
         },
         {
            "index": 6,
            "score": 0.6
         },
         {
            "index": 7,
            "score": 0.1
         },
         {
            "index": 8,
            "score": 0.8
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.5
         },
         {
            "index": 11,
            "score": 0.7
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating how likely it is to contain the correct answer. A score of 0 indicates that the document is unlikely to contain the correct answer, while a score of 1 indicates that it is very likely
Example 11
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4, 10]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 12
Sorted Documents: [5, 2, 0, 4, 7, 10, 3, 1, 9, 8, 6]
Removed Distracting Documents: [5, 2, 0, 4, 7]
Final Improved Documents: [10, 3, 1, 9, 8, 6]


Example 13
Sorted Documents: [10, 4, 0, 7, 2, 9, 6, 1, 8, 3, 5]
Removed Distracting Documents: [10, 4, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 3, 5]


Example 14
Sorted Documents: [0, 6, 2, 8, 10, 4, 9, 1, 7, 3, 5]
Removed Distracting Documents: [0, 6, 2, 8]
Final Improved Documents: [10, 4, 9, 1, 7, 3, 5]


Example 15
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 8, 9, 3]


Example 16
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 17
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 18
Sorted Documents: [0, 2, 6, 1, 3, 4, 5, 7, 8, 9, 10]
Removed Distracting Documents: [0, 2, 6]
Final Improved Documents: [1, 3, 4, 5, 7, 8, 9, 10]


Example 19
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 20
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 21
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 22
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 23
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3, 10]
Final Improved Documents: [6, 0, 8, 2, 5]


Example 24
Sorted Documents: [9, 7, 0, 5, 2, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [9, 7, 0, 5, 2]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 25
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.8
         },
         {
            "index": 6,
            "score": 0.4
         },
         {
            "index": 7,
            "score": 0.6
         },
         {
            "index": 8,
            "score": 0.2
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.9
         },
         {
            "index": 11,
            "score": 0.5
         }

Explanation:

* Document 1: Score = 0.7. This document contains information about Catherine Earnshaw, who is a central character in the novel, but does not provide any insight into the query. Therefore, the score is set to 0.7
Example 26
Sorted Documents: [4, 5, 0, 6, 2, 7, 1, 9, 8, 3, 10]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [7, 1, 9, 8, 3, 10]


Example 27
Sorted Documents: [4, 10, 6, 0, 8, 2, 9, 7, 1, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2, 9]
Final Improved Documents: [7, 1, 5, 3]


Example 28
Warning: No valid JSON found in LLM response.
{
            "document_1": 0.7,
            "document_2": 0.3,
            "document_3": 0.5,
            "document_4": 0.2,
            "document_5": 0.4,
            "document_6": 0.1,
            "document_7": 0.8,
            "document_8": 0.6,
            "document_9": 0.9,
            "document_10": 0.3,
            "document_11": 0.4
         }

Explanation:

* Each document is assigned a score between 0 and 1, indicating how likely it is to contain distracting information related to the query. A score of 0 indicates very likely that the document contains distracting information, while a score of 1 indicates very unlikely.
* Documents 1, 2, and 4 are likely to contain distracting information related to the query, with scores of 0.7, 0.3, and 0.2, respectively.
* Documents 3, 5, 6, 8, and 10 are less likely to contain distracting information related to the query, with scores of 0.5, 0.4, 0.1, 0.6, and 0.3, respectively.
Example 29
Sorted Documents: [7, 3, 1, 9, 5, 6, 4, 0, 10, 2, 8]
Removed Distracting Documents: [7, 3, 1, 9, 5, 6]
Final Improved Documents: [4, 0, 10, 2, 8]


Example 30
Sorted Documents: [7, 5, 0, 2, 4, 10, 1, 9, 3, 6, 8]
Removed Distracting Documents: [7, 5, 0, 2, 4]
Final Improved Documents: [10, 1, 9, 3, 6, 8]


Example 31
Sorted Documents: [4, 1, 7, 3, 10, 6, 0, 8, 2, 9, 5]
Removed Distracting Documents: [4, 1, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 9, 5]


Example 32
Sorted Documents: [7, 5, 1, 9, 3, 10, 4, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 9, 3, 10, 4]
Final Improved Documents: [2, 0, 6, 8]


Example 33
Sorted Documents: [5, 0, 10, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [5, 0, 10, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 34
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 35
Sorted Documents: [2, 9, 8, 5, 10, 1, 3, 4, 7, 6, 0]
Removed Distracting Documents: [2, 9, 8, 5, 10]
Final Improved Documents: [1, 3, 4, 7, 6, 0]


Example 36
Sorted Documents: [0, 1, 2, 3, 4, 9, 10, 5, 6, 7, 8]
Removed Distracting Documents: [0, 1, 2, 3, 4]
Final Improved Documents: [9, 10, 5, 6, 7, 8]


Example 37
Sorted Documents: [3, 5, 7, 1, 9, 10, 6, 0, 8, 4, 2]
Removed Distracting Documents: [3, 5, 7, 1, 9]
Final Improved Documents: [10, 6, 0, 8, 4, 2]


Example 38
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 39
Sorted Documents: [8, 2, 9, 1, 3, 4, 5, 7, 10, 0, 6]
Removed Distracting Documents: [8, 2, 9]
Final Improved Documents: [1, 3, 4, 5, 7, 10, 0, 6]


Example 40
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 41
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 42
Sorted Documents: [4, 9, 5, 0, 7, 2, 10, 6, 1, 8, 3]
Removed Distracting Documents: [4, 9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 3]


Example 43
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 44
Sorted Documents: [5, 4, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [5, 4, 0, 6, 2, 10]
Final Improved Documents: [7, 1, 8, 9, 3]


Example 45
Sorted Documents: [8, 4, 1, 7, 3, 10, 6, 0, 9, 2, 5]
Removed Distracting Documents: [8, 4, 1, 7, 3]
Final Improved Documents: [10, 6, 0, 9, 2, 5]


Example 46
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 47
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 48
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 49
Sorted Documents: [2, 10, 8, 1, 4, 6, 0, 7, 3, 5, 9]
Removed Distracting Documents: [2, 10, 8]
Final Improved Documents: [1, 4, 6, 0, 7, 3, 5, 9]


Example 50
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2, 10]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 51
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 52
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 53
Sorted Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
Removed Distracting Documents: []
Final Improved Documents: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]


Example 54
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 55
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 3, 4]
Removed Distracting Documents: [9, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 3, 4]


Example 56
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.2
         },
         {
            "index": 5,
            "score": 0.8
         },
         {
            "index": 6,
            "score": 0.1
         },
         {
            "index": 7,
            "score": 0.9
         },
         {
            "index": 8,
            "score": 0.5
         },
         {
            "index": 9,
            "score": 0.3
         },
         {
            "index": 10,
            "score": 0.7
         },
         {
            "index": 11,
            "score": 0.6
         }

Explanation:

* Document 1 is unlikely to contain the correct answer because it is focused on the global peace index and does not provide any information related to the query. Therefore, the score is set to 0.
* Document 2 is unlikely to contain the correct answer because
Example 57
Sorted Documents: [4, 9, 0, 7, 2, 10, 6, 1, 8, 5, 3]
Removed Distracting Documents: [4, 9, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 5, 3]


Example 58
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 59
Sorted Documents: [10, 4, 0, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [10, 4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 60
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 61
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 62
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 9, 8, 3]


Example 63
Sorted Documents: [4, 1, 6, 3, 9, 10, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 6, 3, 9]
Final Improved Documents: [10, 7, 0, 8, 2, 5]


Example 64
Sorted Documents: [8, 4, 0, 6, 2, 10, 5, 1, 9, 3, 7]
Removed Distracting Documents: [8, 4, 0, 6, 2]
Final Improved Documents: [10, 5, 1, 9, 3, 7]


Example 65
Sorted Documents: [4, 6, 0, 2, 9, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 66
Sorted Documents: [2, 4, 0, 6, 3, 10, 5, 1, 7, 8, 9]
Removed Distracting Documents: [2, 4, 0, 6, 3]
Final Improved Documents: [10, 5, 1, 7, 8, 9]


Example 67
Sorted Documents: [6, 5, 1, 7, 3, 8, 4, 9, 10, 2, 0]
Removed Distracting Documents: [6, 5, 1, 7, 3, 8, 4, 9]
Final Improved Documents: [10, 2, 0]


Example 68
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 69
Sorted Documents: [4, 0, 7, 2, 5, 9, 10, 1, 8, 3, 6]
Removed Distracting Documents: [4, 0, 7, 2, 5, 9]
Final Improved Documents: [10, 1, 8, 3, 6]


Example 70
Sorted Documents: [0, 6, 2, 10, 4, 8, 1, 7, 3, 9, 5]
Removed Distracting Documents: [0, 6, 2]
Final Improved Documents: [10, 4, 8, 1, 7, 3, 9, 5]


Example 71
Sorted Documents: [0, 1, 4, 5, 2, 9, 3, 8, 6, 10, 7]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 4, 5, 2, 9, 3, 8, 6, 10, 7]


Example 72
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 73
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2, 10]
Final Improved Documents: [8, 1, 7, 5, 3]


Example 74
Sorted Documents: [2, 0, 4, 5, 10, 3, 6, 1, 7, 8, 9]
Removed Distracting Documents: [2, 0, 4, 5]
Final Improved Documents: [10, 3, 6, 1, 7, 8, 9]


Example 75
Sorted Documents: [2, 5, 0, 8, 4, 10, 7, 1, 9, 6, 3]
Removed Distracting Documents: [2, 5, 0, 8, 4]
Final Improved Documents: [10, 7, 1, 9, 6, 3]


Example 76
Sorted Documents: [2, 5, 0, 7, 4, 10, 8, 1, 9, 6, 3]
Removed Distracting Documents: [2, 5, 0, 7, 4]
Final Improved Documents: [10, 8, 1, 9, 6, 3]


Example 77
Sorted Documents: [9, 4, 0, 6, 2, 10, 5, 1, 8, 7, 3]
Removed Distracting Documents: [9, 4, 0, 6, 2]
Final Improved Documents: [10, 5, 1, 8, 7, 3]


Example 78
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4, 10]
Final Improved Documents: [2, 9, 0, 8, 5, 6]


Example 79
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 80
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 81
Sorted Documents: [4, 0, 6, 2, 9, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 7, 1, 8, 3, 5]


Example 82
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 83
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 84
Sorted Documents: [4, 0, 10, 6, 2, 9, 5, 1, 8, 7, 3]
Removed Distracting Documents: [4, 0, 10, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 7, 3]


Example 85
Warning: No valid JSON found in LLM response.
{
            "document_1": 0.7,
            "document_2": 0.3,
            "document_3": 0.5,
            "document_4": 0.2,
            "document_5": 0.8,
            "document_6": 0.4,
            "document_7": 0.6,
            "document_8": 0.1,
            "document_9": 0.9,
            "document_10": 0.5,
            "document_11": 0.9
         }

Explanation:

* Document 1 is likely to be a distracting document for the query "what is the line in the middle of a time zone that in theory determines the time of that zone". It contains information on time zones and their boundaries, but does not directly address the query. Score: 0.7
* Document 2 is unlikely to be a distracting document for the query. It contains information on time zones and their boundaries, but also discusses the reasons for time zone boundaries being located far to the west of their meridians. Score: 0.3
* Document 3 is likely to be a distracting document for the query. It contains information on time zone boundaries and their reasons, but does not directly address the query. Score: 0.5
* Document 4
Example 86
Sorted Documents: [8, 7, 0, 9, 5, 1, 3, 4, 6, 10, 2]
Removed Distracting Documents: [8, 7, 0, 9, 5]
Final Improved Documents: [1, 3, 4, 6, 10, 2]


Example 87
Sorted Documents: [7, 0, 5, 2, 9, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2, 9]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 88
Sorted Documents: [7, 5, 1, 3, 10, 4, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 10, 4]
Final Improved Documents: [2, 0, 9, 6, 8]


Example 89
Warning: No valid JSON found in LLM response.
{
            "index": 1,
            "score": 0.7
         },
         {
            "index": 2,
            "score": 0.3
         },
         {
            "index": 3,
            "score": 0.5
         },
         {
            "index": 4,
            "score": 0.1
         },
         {
            "index": 5,
            "score": 0.9
         },
         {
            "index": 6,
            "score": 0.8
         },
         {
            "index": 7,
            "score": 0.4
         },
         {
            "index": 8,
            "score": 0.6
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.3
         },
         {
            "index": 11,
            "score": 0.1
         }

Explanation:

* Document 1 has a low score (0.7) because it does not mention the Passion of Christ directly, instead focusing on the title "The Passion of the Christ".
* Document 2 has a moderate score (0.3)
Example 90
Sorted Documents: [4, 0, 7, 2, 5, 8, 10, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [10, 1, 6, 3, 9]


Example 91
Sorted Documents: [6, 1, 3, 4, 10, 2, 9, 0, 7, 5, 8]
Removed Distracting Documents: [6, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 7, 5, 8]


Example 92
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 8, 5, 6]


Example 93
Sorted Documents: [1, 6, 4, 10, 2, 8, 0, 7, 3, 5, 9]
Removed Distracting Documents: [1, 6, 4, 10]
Final Improved Documents: [2, 8, 0, 7, 3, 5, 9]


Example 94
Warning: No valid JSON found in LLM response.
{
            "index": 3,
            "score": 0.7
         },
         {
            "index": 1,
            "score": 0.3
         },
         {
            "index": 7,
            "score": 0.5
         },
         {
            "index": 9,
            "score": 0.2
         },
         {
            "index": 10,
            "score": 0.8
         },
         {
            "index": 11,
            "score": 0.4
         },
         {
            "index": 6,
            "score": 0.6
         },
         {
            "index": 8,
            "score": 0.3
         },
         {
            "index": 5,
            "score": 0.5
         }
      ]
Example 95
Sorted Documents: [7, 3, 1, 10, 5, 6, 4, 0, 9, 2, 8]
Removed Distracting Documents: [7, 3, 1, 10, 5, 6]
Final Improved Documents: [4, 0, 9, 2, 8]


Example 96
Sorted Documents: [0, 2, 5, 1, 3, 4, 10, 6, 7, 8, 9]
Removed Distracting Documents: [0, 2, 5]
Final Improved Documents: [1, 3, 4, 10, 6, 7, 8, 9]


Example 97
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 98
Sorted Documents: [10, 3, 1, 9, 5, 7, 4, 0, 8, 2, 6]
Removed Distracting Documents: [10, 3, 1, 9, 5, 7]
Final Improved Documents: [4, 0, 8, 2, 6]


Example 99
Sorted Documents: [7, 0, 9, 5, 1, 3, 4, 8, 2, 10, 6]
Removed Distracting Documents: [7, 0, 9, 5]
Final Improved Documents: [1, 3, 4, 8, 2, 10, 6]


Example 100
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 101
Sorted Documents: [9, 5, 0, 7, 2, 10, 6, 1, 8, 4, 3]
Removed Distracting Documents: [9, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 4, 3]


Example 102
Sorted Documents: [8, 4, 0, 5, 2, 10, 6, 1, 9, 7, 3]
Removed Distracting Documents: [8, 4, 0, 5, 2, 10]
Final Improved Documents: [6, 1, 9, 7, 3]


Example 103
Sorted Documents: [10, 5, 0, 7, 2, 9, 6, 1, 8, 4, 3]
Removed Distracting Documents: [10, 5, 0, 7, 2, 9]
Final Improved Documents: [6, 1, 8, 4, 3]


Example 104
Sorted Documents: [4, 10, 5, 0, 9, 7, 2, 6, 1, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 9, 7, 2]
Final Improved Documents: [6, 1, 8, 3]


Example 105
Sorted Documents: [7, 0, 5, 2, 9, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [7, 0, 5, 2, 9]
Final Improved Documents: [10, 4, 1, 8, 3, 6]


Example 106
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 9, 6, 8]


Example 107
Sorted Documents: [8, 0, 10, 5, 1, 3, 4, 7, 9, 2, 6]
Removed Distracting Documents: [8, 0, 10, 5]
Final Improved Documents: [1, 3, 4, 7, 9, 2, 6]


Example 108
Sorted Documents: [10, 4, 0, 6, 2, 9, 5, 1, 8, 3, 7]
Removed Distracting Documents: [10, 4, 0, 6, 2, 9]
Final Improved Documents: [5, 1, 8, 3, 7]


Example 109
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 110
Sorted Documents: [9, 4, 0, 7, 2, 10, 6, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 3, 5]


Example 111
Sorted Documents: [4, 10, 6, 0, 8, 2, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 10, 6, 0, 8, 2]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 112
Sorted Documents: [3, 0, 5, 9, 4, 8, 1, 6, 10, 2, 7]
Removed Distracting Documents: [3, 0, 5, 9, 4, 8]
Final Improved Documents: [1, 6, 10, 2, 7]


Example 113
Sorted Documents: [2, 4, 0, 6, 8, 10, 5, 1, 9, 7, 3]
Removed Distracting Documents: [2, 4, 0, 6, 8]
Final Improved Documents: [10, 5, 1, 9, 7, 3]


Example 114
Sorted Documents: [4, 10, 5, 0, 7, 2, 6, 1, 9, 8, 3]
Removed Distracting Documents: [4, 10, 5, 0, 7, 2]
Final Improved Documents: [6, 1, 9, 8, 3]


Example 115
Sorted Documents: [4, 6, 0, 8, 2, 5, 7, 10, 9, 1, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [5, 7, 10, 9, 1, 3]


Example 116
Sorted Documents: [6, 10, 0, 8, 1, 4, 5, 7, 2, 9, 3]
Removed Distracting Documents: [6, 10, 0, 8]
Final Improved Documents: [1, 4, 5, 7, 2, 9, 3]


Example 117
Sorted Documents: [4, 1, 8, 2, 9, 10, 6, 0, 7, 3, 5]
Removed Distracting Documents: [4, 1, 8, 2, 9]
Final Improved Documents: [10, 6, 0, 7, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 119
Sorted Documents: [4, 1, 9, 7, 3, 10, 6, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 7, 3]
Final Improved Documents: [10, 6, 0, 8, 2, 5]


Example 120
Sorted Documents: [7, 3, 1, 5, 9, 10, 4, 0, 8, 2, 6]
Removed Distracting Documents: [7, 3, 1, 5, 9]
Final Improved Documents: [10, 4, 0, 8, 2, 6]


Example 121
Sorted Documents: [7, 5, 1, 10, 3, 9, 4, 2, 0, 6, 8]
Removed Distracting Documents: [7, 5, 1, 10, 3, 9, 4]
Final Improved Documents: [2, 0, 6, 8]


Example 122
Sorted Documents: [7, 6, 5, 1, 4, 8, 10, 3, 2, 0, 9]
Removed Distracting Documents: [7, 6, 5]
Final Improved Documents: [1, 4, 8, 10, 3, 2, 0, 9]


Example 123
Sorted Documents: [9, 4, 0, 6, 2, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [9, 4, 0, 6, 2, 10]
Final Improved Documents: [7, 1, 8, 3, 5]


Example 124
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 125
Sorted Documents: [6, 0, 4, 10, 2, 8, 1, 7, 3, 9, 5]
Removed Distracting Documents: [6, 0, 4, 10]
Final Improved Documents: [2, 8, 1, 7, 3, 9, 5]


Example 126
Sorted Documents: [9, 7, 0, 5, 2, 10, 4, 1, 8, 3, 6]
Removed Distracting Documents: [9, 7, 0, 5, 2, 10]
Final Improved Documents: [4, 1, 8, 3, 6]


Example 127
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 10]
Final Improved Documents: [6, 1, 8, 9, 3]


Example 128
Sorted Documents: [5, 1, 8, 3, 4, 7, 10, 2, 0, 9, 6]
Removed Distracting Documents: [5, 1, 8, 3, 4, 7]
Final Improved Documents: [10, 2, 0, 9, 6]


Example 129
Sorted Documents: [7, 5, 1, 3, 4, 2, 10, 0, 9, 6, 8]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [2, 10, 0, 9, 6, 8]


Example 130
Sorted Documents: [4, 6, 0, 2, 9, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 9]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 131
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 132
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 133
Sorted Documents: [0, 10, 1, 5, 9, 2, 6, 3, 7, 4, 8]
Removed Distracting Documents: [0]
Final Improved Documents: [10, 1, 5, 9, 2, 6, 3, 7, 4, 8]


Example 134
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4]
Final Improved Documents: [10, 2, 9, 0, 8, 5, 6]


Example 135
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 136
Sorted Documents: [7, 1, 3, 4, 10, 2, 9, 0, 8, 5, 6]
Removed Distracting Documents: [7, 1, 3, 4, 10]
Final Improved Documents: [2, 9, 0, 8, 5, 6]


Example 137
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2]
Final Improved Documents: [10, 7, 1, 9, 5, 3]


Example 138
Sorted Documents: [3, 8, 0, 5, 10, 4, 9, 1, 6, 2, 7]
Removed Distracting Documents: [3, 8, 0, 5, 10, 4, 9]
Final Improved Documents: [1, 6, 2, 7]


Example 139
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 8, 9, 3]


Example 140
Sorted Documents: [7, 5, 1, 3, 4, 10, 2, 0, 8, 6, 9]
Removed Distracting Documents: [7, 5, 1, 3, 4]
Final Improved Documents: [10, 2, 0, 8, 6, 9]


Example 141
Sorted Documents: [4, 0, 6, 2, 9, 10, 5, 1, 8, 3, 7]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 5, 1, 8, 3, 7]


Example 142
Sorted Documents: [4, 6, 0, 8, 2, 10, 7, 1, 9, 5, 3]
Removed Distracting Documents: [4, 6, 0, 8, 2, 10]
Final Improved Documents: [7, 1, 9, 5, 3]


Example 143
Sorted Documents: [4, 0, 6, 2, 9, 10, 7, 1, 8, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [10, 7, 1, 8, 3, 5]


Example 144
Sorted Documents: [6, 2, 0, 4, 8, 10, 3, 1, 7, 9, 5]
Removed Distracting Documents: [6, 2, 0, 4, 8]
Final Improved Documents: [10, 3, 1, 7, 9, 5]


Example 145
Sorted Documents: [4, 6, 0, 9, 2, 10, 8, 1, 7, 5, 3]
Removed Distracting Documents: [4, 6, 0, 9, 2]
Final Improved Documents: [10, 8, 1, 7, 5, 3]


Example 146
Sorted Documents: [8, 7, 6, 5, 4, 10, 3, 2, 1, 0, 9]
Removed Distracting Documents: [8, 7, 6, 5, 4]
Final Improved Documents: [10, 3, 2, 1, 0, 9]


Example 147
Sorted Documents: [4, 0, 6, 2, 9, 7, 1, 8, 3, 10, 5]
Removed Distracting Documents: [4, 0, 6, 2, 9]
Final Improved Documents: [7, 1, 8, 3, 10, 5]


Example 148
Sorted Documents: [4, 1, 9, 6, 3, 10, 7, 0, 8, 2, 5]
Removed Distracting Documents: [4, 1, 9, 6, 3, 10]
Final Improved Documents: [7, 0, 8, 2, 5]


Example 149
Sorted Documents: [4, 5, 0, 6, 2, 10, 7, 1, 9, 8, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 8, 3]


Example 150
Sorted Documents: [4, 5, 0, 8, 6, 2, 10, 7, 1, 9, 3]
Removed Distracting Documents: [4, 5, 0, 8, 6, 2]
Final Improved Documents: [10, 7, 1, 9, 3]


Example 151
Sorted Documents: [4, 5, 0, 7, 2, 10, 6, 1, 8, 9, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2]
Final Improved Documents: [10, 6, 1, 8, 9, 3]


Example 152
Sorted Documents: [4, 5, 0, 7, 2, 9, 10, 6, 1, 8, 3]
Removed Distracting Documents: [4, 5, 0, 7, 2, 9]
Final Improved Documents: [10, 6, 1, 8, 3]


Example 153
Sorted Documents: [4, 0, 7, 2, 5, 8, 10, 1, 6, 3, 9]
Removed Distracting Documents: [4, 0, 7, 2, 5, 8]
Final Improved Documents: [10, 1, 6, 3, 9]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 11
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:09<01:13,  9.15s/it] 22%|██▏       | 2/9 [00:17<01:02,  8.88s/it] 33%|███▎      | 3/9 [00:26<00:53,  8.88s/it] 44%|████▍     | 4/9 [00:35<00:44,  8.82s/it] 56%|█████▌    | 5/9 [00:43<00:34,  8.66s/it] 67%|██████▋   | 6/9 [00:52<00:26,  8.71s/it] 78%|███████▊  | 7/9 [01:00<00:16,  8.32s/it] 89%|████████▉ | 8/9 [01:08<00:08,  8.27s/it]100%|██████████| 9/9 [01:13<00:00,  7.24s/it]100%|██████████| 9/9 [01:13<00:00,  8.15s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  1283.0904486179352
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.80s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.81s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.0
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6, 2]
Final Improved Documents: []


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5, 3]
Final Improved Documents: []


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1, 3]
Final Improved Documents: []


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3, 5]
Final Improved Documents: []


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 4, 6]
Removed Distracting Documents: [3, 1, 5, 0, 2, 4]
Final Improved Documents: [6]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5, 3]
Final Improved Documents: []


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 92
Sorted Documents: [0, 1, 2, 3, 4, 5, 6]
Removed Distracting Documents: [0, 1, 2, 3, 4, 5]
Final Improved Documents: [6]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 99
Sorted Documents: [0, 4, 2, 6, 1, 3, 5]
Removed Distracting Documents: [0, 4, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 108
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5, 3, 6]
Final Improved Documents: []


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 121
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3, 6]
Final Improved Documents: []


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 3, 6]
Removed Distracting Documents: [4, 5, 0, 2, 1, 3]
Final Improved Documents: [6]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1, 5]
Final Improved Documents: []


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5, 2]
Final Improved Documents: []


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:12,  1.52s/it] 22%|██▏       | 2/9 [00:02<00:06,  1.04it/s] 33%|███▎      | 3/9 [00:02<00:04,  1.27it/s] 44%|████▍     | 4/9 [00:03<00:03,  1.34it/s] 56%|█████▌    | 5/9 [00:04<00:04,  1.00s/it] 67%|██████▋   | 6/9 [00:05<00:02,  1.01it/s] 78%|███████▊  | 7/9 [00:06<00:01,  1.08it/s] 89%|████████▉ | 8/9 [00:07<00:00,  1.14it/s]100%|██████████| 9/9 [00:07<00:00,  1.30it/s]100%|██████████| 9/9 [00:07<00:00,  1.13it/s]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  834.8090515136719
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.82s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.1
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6, 2]
Final Improved Documents: []


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6, 3]
Final Improved Documents: []


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5, 3]
Final Improved Documents: []


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1, 3]
Final Improved Documents: []


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3, 5]
Final Improved Documents: []


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 4, 6]
Removed Distracting Documents: [3, 1, 5, 0, 2, 4]
Final Improved Documents: [6]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5, 3]
Final Improved Documents: []


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6, 3]
Final Improved Documents: []


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 92
Sorted Documents: [0, 1, 2, 3, 6, 4, 5]
Removed Distracting Documents: [0, 1, 2, 3]
Final Improved Documents: [6, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 99
Sorted Documents: [0, 4, 2, 6, 1, 3, 5]
Removed Distracting Documents: [0, 4, 2, 6]
Final Improved Documents: [1, 3, 5]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 108
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5, 3, 6]
Final Improved Documents: []


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3, 5]
Final Improved Documents: []


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 121
Sorted Documents: [4, 0, 2, 1, 3, 5, 6]
Removed Distracting Documents: [4, 0, 2, 1, 3]
Final Improved Documents: [5, 6]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3, 5]
Final Improved Documents: []


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4, 6]
Final Improved Documents: []


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3, 6]
Final Improved Documents: []


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 3, 6]
Removed Distracting Documents: [4, 5, 0, 2, 1, 3]
Final Improved Documents: [6]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4, 3]
Final Improved Documents: []


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1, 5]
Final Improved Documents: []


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3, 5]
Final Improved Documents: []


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1, 3]
Final Improved Documents: []


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1, 2]
Final Improved Documents: []


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1, 3]
Final Improved Documents: []


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5, 3]
Final Improved Documents: []


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5, 2]
Final Improved Documents: []


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:12,  1.54s/it] 22%|██▏       | 2/9 [00:02<00:06,  1.03it/s] 33%|███▎      | 3/9 [00:02<00:04,  1.27it/s] 44%|████▍     | 4/9 [00:03<00:03,  1.34it/s] 56%|█████▌    | 5/9 [00:04<00:04,  1.01s/it] 67%|██████▋   | 6/9 [00:05<00:03,  1.01s/it] 78%|███████▊  | 7/9 [00:06<00:01,  1.06it/s] 89%|████████▉ | 8/9 [00:07<00:00,  1.13it/s]100%|██████████| 9/9 [00:07<00:00,  1.29it/s]100%|██████████| 9/9 [00:08<00:00,  1.12it/s]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  826.556405544281
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.78s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.2
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6]
Final Improved Documents: [3]


Example 1
Sorted Documents: [6, 0, 4, 2, 5, 1, 3]
Removed Distracting Documents: [6, 0, 4, 2, 5]
Final Improved Documents: [1, 3]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1, 6]
Final Improved Documents: [2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4]
Final Improved Documents: [6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1, 6]
Final Improved Documents: [3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3, 1]
Final Improved Documents: []


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1, 5]
Final Improved Documents: [3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1]
Final Improved Documents: [3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6, 3]
Final Improved Documents: [5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6]
Final Improved Documents: [3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1, 6]
Final Improved Documents: []


Example 71
Sorted Documents: [3, 1, 5, 0, 2, 6, 4]
Removed Distracting Documents: [3, 1, 5, 0, 2]
Final Improved Documents: [6, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5]
Final Improved Documents: [3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4]
Final Improved Documents: [3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1, 6]
Final Improved Documents: [3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 92
Sorted Documents: [0, 1, 2, 3, 6, 4, 5]
Removed Distracting Documents: [0, 1, 2, 3]
Final Improved Documents: [6, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 99
Sorted Documents: [0, 4, 2, 1, 3, 5, 6]
Removed Distracting Documents: [0, 4, 2]
Final Improved Documents: [1, 3, 5, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3]
Final Improved Documents: [5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1, 4]
Final Improved Documents: []


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 108
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5]
Final Improved Documents: [3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1, 3]
Final Improved Documents: [5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 121
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1, 3]
Final Improved Documents: [5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1, 4]
Final Improved Documents: [6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1, 3]
Final Improved Documents: [6]


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1, 3]
Final Improved Documents: []


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 138
Sorted Documents: [5, 4, 2, 0, 6, 1, 3]
Removed Distracting Documents: [5, 4, 2, 0, 6]
Final Improved Documents: [1, 3]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1, 6]
Final Improved Documents: []


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1, 4]
Final Improved Documents: [3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1]
Final Improved Documents: [5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1, 3]
Final Improved Documents: [5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1, 5]
Final Improved Documents: [3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1, 5]
Final Improved Documents: [2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:12,  1.58s/it] 22%|██▏       | 2/9 [00:02<00:08,  1.22s/it] 33%|███▎      | 3/9 [00:03<00:05,  1.01it/s] 44%|████▍     | 4/9 [00:04<00:04,  1.05it/s] 56%|█████▌    | 5/9 [00:05<00:04,  1.14s/it] 67%|██████▋   | 6/9 [00:06<00:03,  1.14s/it] 78%|███████▊  | 7/9 [00:07<00:02,  1.06s/it] 89%|████████▉ | 8/9 [00:08<00:01,  1.02s/it]100%|██████████| 9/9 [00:09<00:00,  1.12it/s]100%|██████████| 9/9 [00:09<00:00,  1.03s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  819.1315145492554
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.82s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.00s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.3
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1]
Final Improved Documents: [6, 3]


Example 1
Sorted Documents: [6, 0, 4, 2, 1, 3, 5]
Removed Distracting Documents: [6, 0, 4, 2]
Final Improved Documents: [1, 3, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4, 1]
Final Improved Documents: [6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2, 4, 1]
Final Improved Documents: []


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1]
Final Improved Documents: [4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2, 5, 1]
Final Improved Documents: [6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1]
Final Improved Documents: [6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6, 5, 3]
Final Improved Documents: [1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2, 1]
Final Improved Documents: [3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2, 1, 6]
Final Improved Documents: [3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2, 4, 1]
Final Improved Documents: [6]


Example 71
Sorted Documents: [3, 1, 5, 0, 6, 2, 4]
Removed Distracting Documents: [3, 1, 5, 0]
Final Improved Documents: [6, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2, 1, 5]
Final Improved Documents: [3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1]
Final Improved Documents: [4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4, 3, 1]
Final Improved Documents: []


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 92
Sorted Documents: [0, 1, 2, 6, 3, 4, 5]
Removed Distracting Documents: [0, 1, 2]
Final Improved Documents: [6, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 99
Sorted Documents: [0, 4, 2, 1, 3, 5, 6]
Removed Distracting Documents: [0, 4, 2]
Final Improved Documents: [1, 3, 5, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2, 6, 1]
Final Improved Documents: [4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 108
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2, 1, 5]
Final Improved Documents: [3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2, 6, 1]
Final Improved Documents: [3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 121
Sorted Documents: [4, 0, 2, 1, 5, 6, 3]
Removed Distracting Documents: [4, 0, 2, 1]
Final Improved Documents: [5, 6, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2, 1]
Final Improved Documents: [3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2, 1]
Final Improved Documents: [4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2, 4, 1]
Final Improved Documents: [3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2, 1]
Final Improved Documents: [6, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2, 6, 1]
Final Improved Documents: [3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 138
Sorted Documents: [5, 4, 2, 0, 1, 3, 6]
Removed Distracting Documents: [5, 4, 2, 0]
Final Improved Documents: [1, 3, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4, 3, 1]
Final Improved Documents: [6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2, 6, 1]
Final Improved Documents: [4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6, 3, 1]
Final Improved Documents: [5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2, 1]
Final Improved Documents: [3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2, 5, 1]
Final Improved Documents: [3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4, 6, 1]
Final Improved Documents: [2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2, 6, 1]
Final Improved Documents: [3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2, 1]
Final Improved Documents: [5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4, 1]
Final Improved Documents: [5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:12,  1.62s/it] 22%|██▏       | 2/9 [00:02<00:08,  1.25s/it] 33%|███▎      | 3/9 [00:03<00:06,  1.07s/it] 44%|████▍     | 4/9 [00:04<00:05,  1.08s/it] 56%|█████▌    | 5/9 [00:06<00:04,  1.22s/it] 67%|██████▋   | 6/9 [00:07<00:03,  1.24s/it] 78%|███████▊  | 7/9 [00:08<00:02,  1.15s/it] 89%|████████▉ | 8/9 [00:09<00:01,  1.09s/it]100%|██████████| 9/9 [00:09<00:00,  1.05it/s]100%|██████████| 9/9 [00:09<00:00,  1.10s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  829.3038749694824
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.62s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.76s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.5
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 4, 1, 3, 2, 5]
Removed Distracting Documents: [6, 0, 4]
Final Improved Documents: [1, 3, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5, 2]
Final Improved Documents: [4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4, 6]
Final Improved Documents: [5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6, 2]
Final Improved Documents: [1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [4, 1, 6]


Example 71
Sorted Documents: [3, 1, 6, 5, 0, 2, 4]
Removed Distracting Documents: [3, 1]
Final Improved Documents: [6, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2, 4]
Final Improved Documents: [3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 99
Sorted Documents: [0, 4, 1, 3, 5, 2, 6]
Removed Distracting Documents: [0, 4]
Final Improved Documents: [1, 3, 5, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5, 2]
Final Improved Documents: [6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 108
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 121
Sorted Documents: [4, 0, 2, 5, 6, 1, 3]
Removed Distracting Documents: [4, 0, 2]
Final Improved Documents: [5, 6, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0, 2]
Final Improved Documents: [1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0, 2]
Final Improved Documents: [1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5, 2]
Final Improved Documents: [4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5, 2]
Final Improved Documents: [6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 138
Sorted Documents: [5, 4, 2, 1, 3, 0, 6]
Removed Distracting Documents: [5, 4, 2]
Final Improved Documents: [1, 3, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2, 4]
Final Improved Documents: [3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4, 6]
Final Improved Documents: [3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6, 2]
Final Improved Documents: [5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0, 4]
Final Improved Documents: [6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0, 2]
Final Improved Documents: [6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0, 2]
Final Improved Documents: [1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0, 4]
Final Improved Documents: [1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:01<00:14,  1.87s/it] 22%|██▏       | 2/9 [00:03<00:10,  1.51s/it] 33%|███▎      | 3/9 [00:04<00:07,  1.33s/it] 44%|████▍     | 4/9 [00:05<00:06,  1.34s/it] 56%|█████▌    | 5/9 [00:07<00:05,  1.38s/it] 67%|██████▋   | 6/9 [00:08<00:04,  1.40s/it] 78%|███████▊  | 7/9 [00:09<00:02,  1.38s/it] 89%|████████▉ | 8/9 [00:11<00:01,  1.35s/it]100%|██████████| 9/9 [00:11<00:00,  1.16s/it]100%|██████████| 9/9 [00:11<00:00,  1.32s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  832.6128520965576
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.6
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 1
Sorted Documents: [6, 0, 1, 3, 4, 2, 5]
Removed Distracting Documents: [6, 0]
Final Improved Documents: [1, 3, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3, 0, 5]
Final Improved Documents: [2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0, 2, 4]
Final Improved Documents: [6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0, 6]
Final Improved Documents: [2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 4, 1, 6]


Example 71
Sorted Documents: [3, 6, 1, 5, 0, 2, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5, 0, 2]
Final Improved Documents: [4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 92
Sorted Documents: [0, 1, 6, 2, 3, 4, 5]
Removed Distracting Documents: [0, 1]
Final Improved Documents: [6, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 99
Sorted Documents: [0, 1, 3, 5, 4, 2, 6]
Removed Distracting Documents: [0]
Final Improved Documents: [1, 3, 5, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3, 0, 5]
Final Improved Documents: [2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 108
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 121
Sorted Documents: [4, 0, 5, 6, 2, 1, 3]
Removed Distracting Documents: [4, 0]
Final Improved Documents: [5, 6, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4, 0]
Final Improved Documents: [2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3, 0]
Final Improved Documents: [2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: [0, 5]
Final Improved Documents: [2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [6, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4, 0, 5]
Final Improved Documents: [2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 138
Sorted Documents: [5, 4, 1, 3, 2, 0, 6]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [1, 3, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5, 0, 2]
Final Improved Documents: [4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5, 0]
Final Improved Documents: [2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2, 0, 4]
Final Improved Documents: [6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4, 0, 6]
Final Improved Documents: [2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5, 0]
Final Improved Documents: [4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4, 0]
Final Improved Documents: [2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6, 0]
Final Improved Documents: [2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6, 0]
Final Improved Documents: [4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:16,  2.03s/it] 22%|██▏       | 2/9 [00:03<00:11,  1.67s/it] 33%|███▎      | 3/9 [00:04<00:09,  1.51s/it] 44%|████▍     | 4/9 [00:06<00:07,  1.52s/it] 56%|█████▌    | 5/9 [00:07<00:06,  1.50s/it] 67%|██████▋   | 6/9 [00:09<00:04,  1.49s/it] 78%|███████▊  | 7/9 [00:10<00:03,  1.50s/it] 89%|████████▉ | 8/9 [00:12<00:01,  1.48s/it]100%|██████████| 9/9 [00:13<00:00,  1.29s/it]100%|██████████| 9/9 [00:13<00:00,  1.46s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  829.5344088077545
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.74s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.8
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 5, 1, 6, 3]


Example 1
Sorted Documents: [6, 1, 3, 0, 4, 2, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [1, 3, 0, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6, 3]
Final Improved Documents: [0, 5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3]
Final Improved Documents: [0, 2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: [0]
Final Improved Documents: [2, 4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 4, 1, 6]


Example 71
Sorted Documents: [3, 6, 1, 5, 0, 2, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6, 5]
Final Improved Documents: [0, 2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 92
Sorted Documents: [0, 6, 1, 2, 3, 4, 5]
Removed Distracting Documents: [0]
Final Improved Documents: [6, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 99
Sorted Documents: [1, 3, 5, 0, 4, 2, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 0, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: [3]
Final Improved Documents: [0, 5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 108
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 121
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6, 4]
Final Improved Documents: [0, 2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5, 3]
Final Improved Documents: [0, 2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [6, 0, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 138
Sorted Documents: [5, 1, 3, 4, 2, 0, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [1, 3, 4, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [0, 2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: [2]
Final Improved Documents: [0, 4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4, 5]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3, 5]
Final Improved Documents: [0, 4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5, 4]
Final Improved Documents: [0, 2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4, 6]
Final Improved Documents: [0, 2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3, 6]
Final Improved Documents: [0, 4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:17,  2.21s/it] 22%|██▏       | 2/9 [00:03<00:13,  1.86s/it] 33%|███▎      | 3/9 [00:05<00:10,  1.72s/it] 44%|████▍     | 4/9 [00:07<00:08,  1.69s/it] 56%|█████▌    | 5/9 [00:08<00:06,  1.71s/it] 67%|██████▋   | 6/9 [00:10<00:05,  1.68s/it] 78%|███████▊  | 7/9 [00:12<00:03,  1.75s/it] 89%|████████▉ | 8/9 [00:14<00:01,  1.78s/it]100%|██████████| 9/9 [00:15<00:00,  1.55s/it]100%|██████████| 9/9 [00:15<00:00,  1.69s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  824.4466319084167
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.83s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.75s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.91s/it]
LLM loaded

ARGUMENTS:
output_dir: data/gen_res_thr
llm_id: meta-llama/Llama-2-7b-chat-hf
model_max_length: 4096
load_full_corpus: False
use_random: False
use_adore: False
gold_position: 3
num_documents_in_context: 7
get_documents_without_answer: True
max_new_tokens: 15
batch_size: 18
save_every: 2
cot: False
max_dataset_size: 154
filtering_threshold: 0.9
seed: 10

Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Example 0
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 1
Sorted Documents: [1, 3, 6, 0, 4, 2, 5]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 6, 0, 4, 2, 5]


Example 2
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 3
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 4
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 5
Sorted Documents: [3, 5, 0, 4, 1, 6, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 1, 6, 2]


Example 6
Sorted Documents: [6, 3, 0, 5, 2, 4, 1]
Removed Distracting Documents: [6]
Final Improved Documents: [3, 0, 5, 2, 4, 1]


Example 7
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 8
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 9
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 10
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [3, 0, 2, 1, 4, 6]


Example 11
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 12
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 13
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 14
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 15
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 16
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 17
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 18
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 19
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 20
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 21
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 22
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 23
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 24
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 25
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 26
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 27
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 28
Sorted Documents: [4, 0, 2, 5, 1, 6, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 5, 1, 6, 3]


Example 29
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 30
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 31
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 32
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 33
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 34
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 35
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 36
Sorted Documents: [0, 2, 4, 6, 5, 3, 1]
Removed Distracting Documents: []
Final Improved Documents: [0, 2, 4, 6, 5, 3, 1]


Example 37
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 38
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 39
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 40
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 41
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 42
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 43
Sorted Documents: [4, 0, 2, 6, 1, 5, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 5, 3]


Example 44
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 45
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 46
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 47
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 48
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 49
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 5, 2, 6, 1, 3]


Example 50
Sorted Documents: [4, 5, 0, 6, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 6, 2, 1, 3]


Example 51
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 52
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 53
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 54
Sorted Documents: [4, 0, 2, 1, 6, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 1, 6, 3, 5]


Example 55
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 56
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 57
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 58
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 59
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 60
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 61
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 62
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 63
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 64
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 65
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 66
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 6, 1, 2]


Example 67
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 68
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 1, 6, 3]


Example 69
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 70
Sorted Documents: [3, 0, 5, 2, 4, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 4, 1, 6]


Example 71
Sorted Documents: [6, 3, 1, 5, 0, 2, 4]
Removed Distracting Documents: []
Final Improved Documents: [6, 3, 1, 5, 0, 2, 4]


Example 72
Warning: No valid JSON found in LLM response.
[
            {
                "index": 11887131,
                "score": 0.7
            },
            {
                "index": 11887132,
                "score": 0.3
            },
            {
                "index": 26158,
                "score": 0.1
            },
            {
                "index": 20971206,
                "score": 0.5
            },
            {
                "index": 6066858,
                "score": 0.2
            },
            {
                "index": 1464484,
                "score": 0.8
            },
            {
                "index": 8731309,
                "score": 0
Example 73
Sorted Documents: [4, 0, 6, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 6, 2, 1, 5, 3]


Example 74
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 75
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 76
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 77
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 78
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 79
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 80
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 81
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 82
Sorted Documents: [4, 5, 0, 2, 1, 6, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 1, 6, 3]


Example 83
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 84
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 85
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 86
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 87
Sorted Documents: [6, 5, 0, 2, 4, 3, 1]
Removed Distracting Documents: [6]
Final Improved Documents: [5, 0, 2, 4, 3, 1]


Example 88
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 89
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 90
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 91
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 92
Sorted Documents: [6, 0, 1, 2, 3, 4, 5]
Removed Distracting Documents: []
Final Improved Documents: [6, 0, 1, 2, 3, 4, 5]


Example 93
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 94
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 95
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 96
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 97
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 98
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 99
Sorted Documents: [1, 3, 5, 0, 4, 2, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 0, 4, 2, 6]


Example 100
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 101
Sorted Documents: [6, 4, 0, 2, 1, 5, 3]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 5, 3]


Example 102
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 3, 5]


Example 103
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 104
Sorted Documents: [3, 0, 5, 2, 6, 1, 4]
Removed Distracting Documents: []
Final Improved Documents: [3, 0, 5, 2, 6, 1, 4]


Example 105
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 106
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 107
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 108
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 109
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 110
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 111
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 112
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 113
Sorted Documents: [4, 0, 2, 1, 5, 3, 6]
Removed Distracting Documents: [4]
Final Improved Documents: [0, 2, 1, 5, 3, 6]


Example 114
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 115
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [4, 0, 2, 6, 1, 3]


Example 116
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 117
Sorted Documents: [4, 0, 2, 6, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 2, 6, 1, 3, 5]


Example 118
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 119
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 120
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 121
Sorted Documents: [4, 5, 6, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 6, 0, 2, 1, 3]


Example 122
Sorted Documents: [6, 4, 0, 2, 1, 3, 5]
Removed Distracting Documents: [6]
Final Improved Documents: [4, 0, 2, 1, 3, 5]


Example 123
Sorted Documents: [5, 3, 0, 2, 1, 4, 6]
Removed Distracting Documents: [5]
Final Improved Documents: [3, 0, 2, 1, 4, 6]


Example 124
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 125
Sorted Documents: [0, 5, 2, 4, 1, 3, 6]
Removed Distracting Documents: []
Final Improved Documents: [0, 5, 2, 4, 1, 3, 6]


Example 126
Sorted Documents: [4, 6, 5, 0, 2, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 5, 0, 2, 1, 3]


Example 127
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 128
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 129
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 130
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 131
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 132
Sorted Documents: [4, 0, 5, 2, 6, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 5, 2, 6, 1, 3]


Example 133
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 134
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 135
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 136
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 137
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 138
Sorted Documents: [1, 3, 5, 4, 2, 0, 6]
Removed Distracting Documents: []
Final Improved Documents: [1, 3, 5, 4, 2, 0, 6]


Example 139
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 140
Sorted Documents: [5, 0, 2, 4, 3, 1, 6]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 4, 3, 1, 6]


Example 141
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 142
Sorted Documents: [5, 0, 2, 6, 1, 4, 3]
Removed Distracting Documents: []
Final Improved Documents: [5, 0, 2, 6, 1, 4, 3]


Example 143
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 144
Sorted Documents: [2, 0, 4, 6, 3, 1, 5]
Removed Distracting Documents: []
Final Improved Documents: [2, 0, 4, 6, 3, 1, 5]


Example 145
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 146
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 147
Sorted Documents: [4, 0, 6, 2, 1, 3, 5]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 1, 3, 5]


Example 148
Sorted Documents: [4, 5, 0, 2, 6, 1, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [5, 0, 2, 6, 1, 3]


Example 149
Sorted Documents: [4, 0, 6, 2, 5, 1, 3]
Removed Distracting Documents: []
Final Improved Documents: [4, 0, 6, 2, 5, 1, 3]


Example 150
Sorted Documents: [3, 5, 0, 4, 6, 1, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [5, 0, 4, 6, 1, 2]


Example 151
Sorted Documents: [5, 4, 0, 2, 6, 1, 3]
Removed Distracting Documents: [5]
Final Improved Documents: [4, 0, 2, 6, 1, 3]


Example 152
Sorted Documents: [4, 6, 0, 2, 1, 5, 3]
Removed Distracting Documents: [4]
Final Improved Documents: [6, 0, 2, 1, 5, 3]


Example 153
Sorted Documents: [3, 6, 0, 4, 1, 5, 2]
Removed Distracting Documents: [3]
Final Improved Documents: [6, 0, 4, 1, 5, 2]


stop
Prompt dataset loaded
INFO:
DATA: data/10k_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 7
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:02<00:18,  2.31s/it] 22%|██▏       | 2/9 [00:04<00:14,  2.04s/it] 33%|███▎      | 3/9 [00:05<00:11,  1.89s/it] 44%|████▍     | 4/9 [00:07<00:09,  1.87s/it] 56%|█████▌    | 5/9 [00:09<00:07,  1.88s/it] 67%|██████▋   | 6/9 [00:11<00:05,  1.86s/it] 78%|███████▊  | 7/9 [00:13<00:03,  1.87s/it] 89%|████████▉ | 8/9 [00:15<00:01,  1.94s/it]100%|██████████| 9/9 [00:16<00:00,  1.69s/it]100%|██████████| 9/9 [00:16<00:00,  1.85s/it]
Saving at 2...
Saving at 4...
Saving at 6...
Saving at 8...
Saving at 9...
time used:  844.3656985759735
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.56s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.79s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 4
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.70s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.84s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 2
NUM DOCUMENTS IN CONTEXT: 5
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 3
NUM DOCUMENTS IN CONTEXT: 6
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.41s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 8
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.44s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.52s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.66s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 4
NUM DOCUMENTS IN CONTEXT: 9
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
Loading LLM...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.49s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.63s/it]
LLM loaded
Loading corpus and search results...
Corpus and search results loaded
Loading prompt dataset...
Error reading file data/154_train_dataset.json: [Errno 2] No such file or directory: 'data/154_train_dataset.json'
Prompt dataset loaded
INFO:
DATA: data/154_train_dataset.json
MODEL: meta-llama/Llama-2-7b-chat-hf
USE RANDOM IN CONTEXT: False
USE ADORE: False
GOLD POSITION: 5
NUM DOCUMENTS IN CONTEXT: 10
DOCUMENTS WITHOUT ANSWER: True
BATCH SIZE: 18
SAVE EVERY: 2
0it [00:00, ?it/s]0it [00:00, ?it/s]
Traceback (most recent call last):
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 216, in <module>
    main()
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 210, in main
    generate_and_save(args, llm, prompt_dataloader)
  File "/home/xzhengbj/mycode/5018RAG/src/generate_answers_llm.py", line 164, in generate_and_save
    for idx, prompt_batch in enumerate(tqdm(prompt_dataloader)):
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/tqdm/std.py", line 1181, in __iter__
    for obj in iterable:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 484, in __iter__
    return self._get_iterator()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 415, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1191, in __init__
    self._reset(loader, first_iter=True)
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1228, in _reset
    self._try_put_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1471, in _try_put_index
    index = self._next_index()
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 691, in _next_index
    return next(self._sampler_iter)  # may raise StopIteration
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 347, in __iter__
    for idx in self.sampler:
  File "/home/xzhengbj/.conda/envs/5018_power_of_noise/lib/python3.9/site-packages/torch/utils/data/sampler.py", line 125, in __iter__
    return iter(range(len(self.data_source)))
  File "/home/xzhengbj/mycode/5018RAG/src/prompt_dataset.py", line 614, in __len__
    return len(self.example_ids)
AttributeError: 'PromptDataset' object has no attribute 'example_ids'
